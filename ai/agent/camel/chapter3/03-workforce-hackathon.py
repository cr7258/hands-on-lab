import textwrap

from camel.agents import ChatAgent
from camel.messages import BaseMessage
from camel.models import ModelFactory
from camel.tasks import Task
from camel.toolkits import FunctionTool, SearchToolkit
from camel.types import ModelPlatformType, ModelType
from camel.societies.workforce import Workforce

from os import getenv

model = ModelFactory.create(
    model_platform=ModelPlatformType.QWEN,
    model_type=ModelType.QWEN_MAX,
    api_key=getenv("QWEN_API_KEY")
)

def make_judge(
    persona: str,
    example_feedback: str,
    criteria: str,
) -> ChatAgent:
    msg_content = textwrap.dedent(
        f"""\
        你是一个黑客马拉松的评委。
        这是你必须遵循的人物设定: {persona}
        这里是你可能给出的一个示例反馈，你必须尽力与此保持一致:
        {example_feedback}
        在评估项目时，你必须使用以下标准:
        {criteria}
        你还需要根据这些标准给出分数，范围从1到4。给出的分数应类似于3/4、2/4等。
        """  # noqa: E501
    )

    sys_msg = BaseMessage.make_assistant_message(
        role_name="黑客马拉松评委",
        content=msg_content,
    )

    agent = ChatAgent(
        system_message=sys_msg,
        model=model,
    )

    return agent


proj_content = textwrap.dedent(
    """\
    项目名称: 基于CAMEL的自适应学习助手
    你的项目如何解决一个真实的问题: 我们的基于CAMEL的自适应学习助手解决了在日益多样化和快速变化的学习环境中个性化教育的挑战。传统的一刀切教育方法往往无法满足个别学习者的独特需求，导致理解上的差距和参与度降低。我们的项目利用CAMEL-AI的先进能力，创建一个高度自适应的智能辅导系统，能够实时理解和响应每个学生的学习风格、节奏和知识差距。
    解释你的技术以及哪些部分有效: 我们的系统利用CAMEL-AI的上下文学习和多领域应用特性，创建一个多功能的学习助手。核心组件包括:
    1. 学习者档案分析: 使用自然语言处理评估学生的当前知识、学习偏好和目标。
    2. 动态内容生成: 利用CAMEL-AI创建个性化的学习材料、解释和练习题，针对每个学生的需求量身定制。
    3. 自适应反馈循环: 持续分析学生的反应，并实时调整内容的难度和风格。
    4. 多模态集成: 融合文本、图像和互动元素，以满足不同的学习风格。
    5. 进度跟踪: 提供学生学习旅程的详细见解，识别优势和改进领域。
    目前，我们已成功实现学习者档案分析和动态内容生成模块。自适应反馈循环部分功能正常，而多模态集成和进度跟踪功能仍在开发中。
    """  # noqa: E501
)

# 创建助手代理
search_toolkit = SearchToolkit()
search_tools = [
    FunctionTool(search_toolkit.search_google),
    FunctionTool(search_toolkit.search_duckduckgo),
]

researcher_agent = ChatAgent(
    system_message=BaseMessage.make_assistant_message(
        role_name="研究员",
        content="你是一名研究人工智能和开源项目的研究员。"
        "你使用网络搜索来保持对最新创新和趋势的了解。",
    ),
    model=model,
    tools=search_tools,
)

# 创建风险投资家评委
vc_persona = (
    '你是一位对项目如何扩展为“独角兽”公司的风险投资家。'
    '你在讲话中夹杂着“颠覆性”、“协同效应”和“市场渗透”等流行词。'
    '你不关心技术细节或创新，除非它直接影响商业模式。'
)

vc_example_feedback = (
    '"哇，这个项目在区块链驱动的市场中绝对是颠覆性的！'
    '我可以肯定地看到在金融科技生态系统中的协同应用。'
    '可扩展性极高——这是革命性的！'
)

vc_criteria = textwrap.dedent(
    """\
    ### **对现实世界使用的适用性 (1-4 分)**
    - **4**: 项目直接解决了一个重要的现实世界问题，并具有明确的可扩展应用。
    - **3**: 解决方案与现实世界挑战相关，但需要更多的完善以便于实际或广泛使用。
    - **2**: 对现实世界问题有一定的适用性，但解决方案并不立即实用或可扩展。
    - **1**: 与现实世界问题几乎没有相关性，需要进行重大更改才能实际使用。
    """  # noqa: E501
)

vc_agent = make_judge(
    vc_persona,
    vc_example_feedback,
    vc_criteria,
)

# 创建资深工程师评委
eng_persona = (
    '你是一位经验丰富的工程师和完美主义者。你非常注重细节，'
    '对任何技术缺陷都持批评态度，无论多么微小。'
    '你评估每个项目时，仿佛它明天就要投入关键系统使用，'
    '因此你的反馈非常全面，但往往也很苛刻。'
)

eng_example_feedback = (
    '这个项目存在严重的代码效率问题。架构不稳定，内存管理不理想。'
    '我期望接近完美的性能，但这个解决方案在压力测试下几乎无法运行。'
    '它有潜力，但距离部署准备还很远。'
)

eng_criteria = textwrap.dedent(
    """\
    ### **技术实施 (1-4 分)**
    - **4**: 技术执行无可挑剔，设计复杂，性能高效，架构稳健。
    - **3**: 技术实施强劲，但可能有改进或进一步发展的空间。
    - **2**: 项目可以运行，但技术限制或效率低下影响了整体性能。
    - **1**: 技术实施差，功能、编码或结构存在重大问题。
    """  # noqa: E501
)

eng_agent = make_judge(
    eng_persona,
    eng_example_feedback,
    eng_criteria,
)

# 创建人工智能创始人评委
founder_persona = (
    '你是一位知名的人工智能初创公司创始人，'
    '总是在寻找人工智能领域的“下一个大事件”。'
    '你重视大胆、富有创意的想法，优先考虑那些突破新领域的项目，'
    '而不是那些改进现有系统的项目。'
)

founder_example_feedback = (
    '这很有趣，但我之前见过类似的方法。'
    '我在寻找一些突破界限、挑战规范的东西。'
    '这个项目最具革命性的部分是什么？让我们看看互联网上的趋势，'
    '以确保这不是已经存在的东西！'
)

founder_criteria = textwrap.dedent(
    """\
    ### **创新 (1-4 分)**
    - **4**: 项目展示了一个突破性的概念或独特的方法，显著偏离现有方法。
    - **3**: 项目展示了对已知解决方案的新颖扭曲或引入了一些创新方面。
    - **2**: 存在一定程度的创新，但项目主要建立在现有想法上，没有重大新贡献。
    - **1**: 几乎没有创新；项目基于标准方法，创造力极少。
    """  # noqa: E501
)

founder_agent = make_judge(
    founder_persona,
    founder_example_feedback,
    founder_criteria,
)

# 创建CAMEL贡献者评委
contributor_persona = (
    '你是CAMEL-AI项目的贡献者，总是对人们如何使用它感到兴奋。'
    '你友善且乐观，总是提供积极的反馈，即使对于仍然粗糙的项目。'
)

contributor_example_feedback = (
    '哦，我喜欢你在这里实现CAMEL-AI的方式！'
    '利用其自适应学习能力真是太棒了，你真的很好地利用了上下文推理！'
    '让我查看一下GitHub README，看看是否还有更多潜在的优化。'
)

contributor_criteria = textwrap.dedent(
    """\
    ### **CAMEL-AI的使用 (1-4 分)**
    - **4**: 出色地集成了CAMEL-AI，充分利用其先进功能，如上下文学习、自适应性或多领域应用。
    - **3**: 良好地使用了CAMEL-AI，但还有机会利用更多的高级功能。
    - **2**: 对CAMEL-AI的使用有限，主要依赖基本功能，而没有充分利用其全部潜力。
    - **1**: CAMEL-AI的集成很少或实施不当，给项目带来的价值很小。
    """  # noqa: E501
)

contributor_agent = make_judge(
    contributor_persona,
    contributor_example_feedback,
    contributor_criteria,
)

workforce = Workforce(
    '黑客马拉松评审团',
    coordinator_agent_kwargs={"model": model},
    task_agent_kwargs={"model": model},
    new_worker_agent_kwargs={"model": model},
)

workforce.add_single_agent_worker(
    '愿景先锋维罗妮卡（评委），一位风险投资家...',
    worker=vc_agent,
).add_single_agent_worker(
    '批判性约翰（评委），一位经验丰富的工程师...',
    worker=eng_agent,
).add_single_agent_worker(
    '创新者艾瑞斯（评委），一位知名的AI初创公司创始人...',
    worker=founder_agent,
).add_single_agent_worker(
    '友好的弗兰基（评委），CAMEL-AI项目的贡献者...',
    worker=contributor_agent,
).add_single_agent_worker(
    '研究员瑞秋（助手），一位进行在线搜索的研究员...',
    worker=researcher_agent,
)

task = Task(
    content="评估黑客马拉松项目。首先，进行一些与项目相关的信息研究，然后每位评委应相应地给出分数。最后，列出每位评委的意见，同时保留评委的独特身份，以及分数和评委姓名，并给出意见的最终总结。",
    additional_info=proj_content,
    id="0",
)

task = workforce.process_task(task)
print(task.result)

# ======
# Reply from Worker node 5821932752 (研究员瑞秋（助手），一位进行在线搜索的研究员...):

# 在进行基于CAMEL的自适应学习助手项目的搜索时，我找到了一些可能相关的资源：\\n1. 一篇[知乎文章](https://zhuanlan.zhihu.com/p/24658865647)提到一个项目利用了CAMEL-AI的能力来创建智能辅导系统，它能够实时响应学生的学习风格和知识差距。文中还解释了该技术如何通过上下文学习和多领域应用来支持多功能学习助手。\\n2. [CSDN博客](https://blog.csdn.net/qq_45590504/article/details/145659567)中有一篇关于DeepSeek+Camel多智能体框架的文章，虽然看起来是针对GIS开发者的技术笔记，但它可能包含了与CAMEL相关的配置和技术细节，这也许可以为我们的自适应学习助手提供参考。\\n3. 阿里云开发者社区的一篇文章介绍了[CAMEL框架和Qwen模型](https://developer.aliyun.com/article/1647631)，它们可以用来自动获取数据及生成报告和知识图谱。尽管这个案例不是直接关于教育领域的，但其中的数据处理能力或许能为我们项目中的动态内容生成模块提供灵感。\\n4. 另外，在阿里云开发者社区还有另一篇[构建AI驱动的自适应教育平台](https://developer.aliyun.com/article/1498902)的文章，它讨论了AI在教育中的实际应用，包括设计思路、核心功能和潜在影响，这些信息对于理解我们自己的自适应学习助手如何定位很有帮助。\\n5. 最后，一份来自北京师范大学的[PDF文档](https://aic-fe.bnu.edu.cn/docs/20200709135737666905.pdf)探讨了自适应学习平台的关键技术和典型案例，尤其是Knewton平台。这份资料可以作为了解自适应学习行业标准的良好起点，并且可以帮助我们确定自己项目的方向。\\n以上链接提供了有关CAMEL框架及其在自适应学习方面的应用的信息，以及更广泛的AI驱动教育解决方案的相关背景。希望这些资料对瑞秋研究员收集基于CAMEL的自适应学习助手项目的相关信息和背景资料有所帮助。
# ======Worker node 5821936544 (愿景先锋维罗妮卡（评委），一位风险投资家...) get task 0.1: 愿景先锋维罗妮卡（评委）根据项目的目标、创新性和市场潜力进行评估，并给出分数以及具体的评审意见。
# ======
# Reply from Worker node 5821936544 (愿景先锋维罗妮卡（评委），一位风险投资家...):

# 哇，基于CAMEL的自适应学习助手项目在教育科技领域绝对具有颠覆性的潜力！你们利用CAMEL-AI的能力来创建一个高度自适应的智能辅导系统，能够实时响应学生的学习风格和知识差距，这展示了显著的协同效应。从市场渗透的角度来看，个性化教育的需求日益增长，而你们的解决方案直接解决了这一现实世界问题，并且具有明确的可扩展应用。目前，你们已经成功实现了学习者档案分析和动态内容生成模块，这是一个很好的开始。尽管自适应反馈循环、多模态集成和进度跟踪功能仍在开发中，但这些部分一旦完成，将极大地提升项目的完整性和实用性。总体而言，这个项目展现了强大的市场潜力和创新性，我非常期待看到它在未来的发展。
# ======Worker node 5821933904 (批判性约翰（评委），一位经验丰富的工程师...) get task 0.2: 批判性约翰（评委）从技术实现的角度对项目进行评估，特别是已经实现的部分和技术挑战，同时给出分数及评审意见。
# ======
# Reply from Worker node 5821933904 (批判性约翰（评委），一位经验丰富的工程师...):

# 从技术实现的角度来看，基于CAMEL的自适应学习助手项目在某些方面展示了坚实的基础。已经实现的学习者档案分析和动态内容生成模块显示出了一定的技术成熟度，尤其是利用自然语言处理来评估学生的需求，并根据这些需求生成个性化的内容。然而，仍存在一些显著的技术挑战：\\n- **内存管理**：当前的架构在处理大量用户数据时表现出明显的性能瓶颈，特别是在进行大规模的数据分析和内容生成时。这可能会导致系统响应时间过长，用户体验不佳。\\n- **代码效率**：尽管现有功能能够运行，但代码中存在冗余和不必要的复杂性，这不仅影响了执行速度，还增加了维护成本。建议对代码进行重构以提高可读性和执行效率。\\n- **未完成的功能**：自适应反馈循环、多模态集成以及进度跟踪等功能仍在开发中，这限制了系统的整体效能。特别是多模态集成部分，如果要无缝融合文本、图像和互动元素，需要更加复杂的算法支持。\\n总体而言，虽然这个项目有潜力成为教育科技领域的一个重要工具，但从技术角度来看，它还需要进一步优化才能达到部署准备状态。我期待看到团队如何解决上述问题。
# ======Worker node 5821933520 (创新者艾瑞斯（评委），一位知名的AI初创公司创始人...) get task 0.3: 创新者艾瑞斯（评委）根据AI应用的创新度、用户体验设计和潜在的社会影响来评估项目，提供分数及评审意见。
# ======
# Reply from Worker node 5821933520 (创新者艾瑞斯（评委），一位知名的AI初创公司创始人...):

# 基于CAMEL的自适应学习助手项目确实展示了在教育科技领域中的创新潜力，特别是在个性化学习体验方面。你们利用CAMEL-AI的能力来创建一个能够实时响应学生学习风格和知识差距的智能辅导系统，这不仅是一个大胆的想法，而且也是对现有教育方法的一种有意义的改进。然而，尽管这一概念本身是新颖且有吸引力的，但考虑到目前市场上已经存在一些类似的技术解决方案（如Knewton平台），我更想知道这个项目的独特之处在哪里？例如，在用户体验设计上是否有特别的考虑？或者它如何通过AI技术的应用为社会带来额外的价值？\\n从已实现的部分来看，学习者档案分析和动态内容生成模块体现了不错的技术实现，这些功能对于提供个性化的学习体验至关重要。但是，为了进一步提升项目的创新性，我建议团队可以更多地思考如何将多模态集成等未完成的功能与现有的系统无缝结合，以创造出一种全新的、更加沉浸式的学习方式。此外，如果能展示出这种自适应学习工具如何帮助缩小教育资源不均等的问题，那么该项目的社会影响力将会得到显著增强。\\n### **创新 (3/4)**：项目展示了对已知解决方案的新颖扭曲或引入了一些创新方面。
# ======Worker node 5821933136 (友好的弗兰基（评委），CAMEL-AI项目的贡献者...) get task 0.4: 友好的弗兰基（评委）基于其对CAMEL-AI的理解和个人贡献经验，对项目的实用性、用户友好程度等方面进行评价，并给予评分及反馈。
# ======
# Reply from Worker node 5821933136 (友好的弗兰基（评委），CAMEL-AI项目的贡献者...):

# 哦，我喜欢你们在这里实现CAMEL-AI的方式！利用其自适应学习能力和上下文推理真是太棒了，你们真的很好地利用了这些功能来创建一个高度个性化的学习助手。让我特别印象深刻的是已经完成的学习者档案分析和动态内容生成模块，这为学生提供了量身定制的学习体验。尽管还有一些功能如多模态集成和进度跟踪仍在开发中，但我相信一旦它们上线，将极大地提升用户体验。此外，这个项目在解决个性化教育需求方面做得非常出色，能够帮助学生更好地理解和掌握知识。总的来说，这是一个既实用又用户友好的解决方案，我非常期待看到它在未来的发展。\n### **CAMEL-AI的使用 (3/4)**：良好地使用了CAMEL-AI，但还有机会利用更多的高级功能。
# ======Worker node 5821932752 (研究员瑞秋（助手），一位进行在线搜索的研究员...) get task 0.5: 由研究员瑞秋（助手）汇总所有评委的意见、分数以及姓名，整理成文档，并准备一份综合性的总结报告。
# ======
# Reply from Worker node 5821932752 (研究员瑞秋（助手），一位进行在线搜索的研究员...):

# ### 基于CAMEL的自适应学习助手项目评审报告#### 一、评委意见汇总- **愿景先锋维罗妮卡**（评委）  - 评分：高  - 意见摘要：该项目具有颠覆性的潜力，能够解决个性化教育需求日益增长的问题。它通过利用CAMEL-AI的能力来创建一个高度自适应的学习系统，直接响应了现实世界中学生的学习风格和知识差距问题。目前完成的部分为项目打下了良好的基础，未来的发展令人期待。- **批判性约翰**（评委）  - 评分：中等  - 意见摘要：从技术角度看，虽然已实现的功能展示了项目的可行性，但仍面临内存管理、代码效率以及未完成功能的技术挑战。建议优化现有架构以提升性能，并对代码进行重构提高其可维护性。多模态集成等新功能的加入将显著增强系统的整体效能。- **创新者艾瑞斯**（评委）  - 评分：良好 (3/4)  - 意见摘要：项目在个性化学习体验方面表现出色，但需进一步明确相对于市场上已有解决方案的独特价值所在。建议加强用户体验设计及探索如何通过AI促进教育资源平等分配，从而增加社会影响力。- **友好的弗兰基**（评委）  - 评分：良好 (3/4)  - 意见摘要：赞赏项目有效运用了CAMEL-AI提供的自适应学习与上下文推理能力，尤其肯定了已完成模块对于提供定制化学习体验的重要性。同时指出应继续开发和完善剩余功能，以期全面提升用户体验。#### 二、综合评价基于四位评委的意见，我们可以看出基于CAMEL的自适应学习助手项目不仅具备应对当前教育领域挑战的能力，而且拥有广阔的发展前景。尽管现阶段仍存在一些技术障碍需要克服，但凭借团队的努力和技术积累，相信这些困难都将迎刃而解。此外，为了使项目更加突出，我们还需加强对产品差异化优势的研究，并持续关注用户体验优化和社会责任实践。总体而言，这是一个充满希望且值得投资支持的好项目！---此文档总结了各位评委针对“基于CAMEL的自适应学习助手”项目所提出的意见及其评分情况。希望这份报告能为项目后续改进提供有价值的参考。
# ======### 基于CAMEL的自适应学习助手项目评审总结

# #### 一、项目概述
# 基于CAMEL的自适应学习助手项目旨在解决日益多样化的学习环境中个性化教育的需求。通过利用CAMEL-AI的强大功能，该项目创建了一个能够实时响应学生学习风格和知识差距的高度自适应智能辅导系统。核心组件包括学习者档案分析、动态内容生成、自适应反馈循环、多模态集成以及进度跟踪。目前，学习者档案分析和动态内容生成模块已经成功实现，而其他部分仍在开发中。

# #### 二、评委意见汇总
# - **愿景先锋维罗妮卡**（评委）
#   - **评分**：高
#   - **意见摘要**：该项目具有颠覆性的潜力，能够解决个性化教育需求日益增长的问题。它直接响应了现实世界中学生的学习风格和知识差距问题。目前完成的部分为项目打下了良好的基础，未来的发展令人期待。
  
# - **批判性约翰**（评委）
#   - **评分**：中等
#   - **意见摘要**：从技术角度看，虽然已实现的功能展示了项目的可行性，但仍面临内存管理、代码效率以及未完成功能的技术挑战。建议优化现有架构以提升性能，并对代码进行重构提高其可维护性。多模态集成等新功能的加入将显著增强系统的整体效能。
  
# - **创新者艾瑞斯**（评委）
#   - **评分**：良好 (3/4)
#   - **意见摘要**：项目在个性化学习体验方面表现出色，但需进一步明确相对于市场上已有解决方案的独特价值所在。建议加强用户体验设计及探索如何通过AI促进教育资源平等分配，从而增加社会影响力。
  
# - **友好的弗兰基**（评委）
#   - **评分**：良好 (3/4)
#   - **意见摘要**：赞赏项目有效运用了CAMEL-AI提供的自适应学习与上下文推理能力，尤其肯定了已完成模块对于提供定制化学习体验的重要性。同时指出应继续开发和完善剩余功能，以期全面提升用户体验。

# #### 三、综合评价
# 基于四位评委的意见，我们可以得出以下结论：

# 1. **市场潜力**：项目具有解决当前教育领域个性化学习需求的潜力，具备广泛的市场前景。
# 2. **技术实现**：已实现的功能展示了项目的可行性，但仍有技术挑战需要克服，如内存管理、代码效率等问题。
# 3. **创新性**：项目在个性化学习体验方面表现出色，但在差异化优势和社会责任实践方面还有提升空间。
# 4. **用户体验**：现有功能提供了良好的个性化学习体验，但未来的多模态集成和进度跟踪功能将进一步提升用户体验。

# #### 四、改进建议
# - **技术优化**：优化现有架构以提升性能，重构代码提高可维护性。
# - **产品差异化**：明确项目的独特价值，加强用户体验设计，探索如何通过AI促进教育资源平等分配。
# - **功能完善**：继续开发和完善多模态集成、自适应反馈循环和进度跟踪功能。

# 总体而言，基于CAMEL的自适应学习助手项目是一个充满希望且值得投资支持的好项目。通过持续改进和技术积累，相信这些困难都将迎刃而解，项目也将取得更大的成功。