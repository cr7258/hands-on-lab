# myapp   0/4     Pending   0          0s
# the pod has not been scheduled yet
apiVersion: v1
kind: Pod
metadata:
  annotations:
    kubectl.kubernetes.io/last-applied-configuration: |
      {"apiVersion":"v1","kind":"Pod","metadata":{"annotations":{},"name":"myapp","namespace":"default"},"spec":{"containers":[{"args":["echo \"main container 1 is starting...\"\nwhile true; do\n  echo \"main container 1 is doing some tasks...\"\n  sleep 3\ndone\n"],"command":["sh","-c"],"image":"busybox:1.35","name":"main-container-1"},{"args":["echo \"main container 2 is starting...\"\nwhile true; do\n  echo \"main container 2 is doing some tasks...\"\n  sleep 3\ndone\n"],"command":["sh","-c"],"image":"busybox:1.35","name":"main-container-2"}],"initContainers":[{"args":["echo \"init container 1 is starting...\"\necho \"init container 1 is doing some tasks...\"\nsleep 10\necho \"init container 1 completed tasks and exited\"\n"],"command":["sh","-c"],"image":"busybox:1.35","name":"init-container-1"},{"args":["echo \"sidecar container 1 is starting...\"\nwhile true; do\n  echo \"sidecar container 1 is doing some tasks...\"\n  sleep 3\ndone\n"],"command":["sh","-c"],"image":"busybox:1.35","name":"sidecar-container-1","readinessProbe":{"exec":{"command":["/bin/sh","-c","echo \"readiness probe of sidecar container 1 is starting...\" \u003e\u003e /proc/1/fd/1\nsleep 30\necho \"readiness probe of sidecar container 1 passed successfully\" \u003e\u003e /proc/1/fd/1\n"]},"timeoutSeconds":999},"restartPolicy":"Always"},{"args":["echo \"sidecar container 2 is starting...\"\nwhile true; do\n  echo \"sidecar container 2 is doing some tasks...\"\n  sleep 3\ndone\n"],"command":["sh","-c"],"image":"busybox:1.35","name":"sidecar-container-2","readinessProbe":{"exec":{"command":["/bin/sh","-c","echo \"readiness probe of sidecar container 2 is starting...\" \u003e\u003e /proc/1/fd/1\nsleep 30\necho \"readiness probe of sidecar container 2 passed successfully\" \u003e\u003e /proc/1/fd/1\n"]},"timeoutSeconds":999},"restartPolicy":"Always"}]}}
  creationTimestamp: "2024-05-29T00:20:15Z"
  name: myapp
  namespace: default
  resourceVersion: "1221021"
  uid: 02f352b5-7041-4ce3-907c-ed66caf11ae6
spec:
  containers:
    - args:
        - |
          echo "main container 1 is starting..."
          while true; do
            echo "main container 1 is doing some tasks..."
            sleep 3
          done
      command:
        - sh
        - -c
      image: busybox:1.35
      imagePullPolicy: IfNotPresent
      name: main-container-1
      resources: {}
      terminationMessagePath: /dev/termination-log
      terminationMessagePolicy: File
      volumeMounts:
        - mountPath: /var/run/secrets/kubernetes.io/serviceaccount
          name: kube-api-access-rjr2p
          readOnly: true
    - args:
        - |
          echo "main container 2 is starting..."
          while true; do
            echo "main container 2 is doing some tasks..."
            sleep 3
          done
      command:
        - sh
        - -c
      image: busybox:1.35
      imagePullPolicy: IfNotPresent
      name: main-container-2
      resources: {}
      terminationMessagePath: /dev/termination-log
      terminationMessagePolicy: File
      volumeMounts:
        - mountPath: /var/run/secrets/kubernetes.io/serviceaccount
          name: kube-api-access-rjr2p
          readOnly: true
  dnsPolicy: ClusterFirst
  enableServiceLinks: true
  initContainers:
    - args:
        - |
          echo "init container 1 is starting..."
          echo "init container 1 is doing some tasks..."
          sleep 10
          echo "init container 1 completed tasks and exited"
      command:
        - sh
        - -c
      image: busybox:1.35
      imagePullPolicy: IfNotPresent
      name: init-container-1
      resources: {}
      terminationMessagePath: /dev/termination-log
      terminationMessagePolicy: File
      volumeMounts:
        - mountPath: /var/run/secrets/kubernetes.io/serviceaccount
          name: kube-api-access-rjr2p
          readOnly: true
    - args:
        - |
          echo "sidecar container 1 is starting..."
          while true; do
            echo "sidecar container 1 is doing some tasks..."
            sleep 3
          done
      command:
        - sh
        - -c
      image: busybox:1.35
      imagePullPolicy: IfNotPresent
      name: sidecar-container-1
      readinessProbe:
        exec:
          command:
            - /bin/sh
            - -c
            - |
              echo "readiness probe of sidecar container 1 is starting..." >> /proc/1/fd/1
              sleep 30
              echo "readiness probe of sidecar container 1 passed successfully" >> /proc/1/fd/1
        failureThreshold: 3
        periodSeconds: 10
        successThreshold: 1
        timeoutSeconds: 999
      resources: {}
      restartPolicy: Always
      terminationMessagePath: /dev/termination-log
      terminationMessagePolicy: File
      volumeMounts:
        - mountPath: /var/run/secrets/kubernetes.io/serviceaccount
          name: kube-api-access-rjr2p
          readOnly: true
    - args:
        - |
          echo "sidecar container 2 is starting..."
          while true; do
            echo "sidecar container 2 is doing some tasks..."
            sleep 3
          done
      command:
        - sh
        - -c
      image: busybox:1.35
      imagePullPolicy: IfNotPresent
      name: sidecar-container-2
      readinessProbe:
        exec:
          command:
            - /bin/sh
            - -c
            - |
              echo "readiness probe of sidecar container 2 is starting..." >> /proc/1/fd/1
              sleep 30
              echo "readiness probe of sidecar container 2 passed successfully" >> /proc/1/fd/1
        failureThreshold: 3
        periodSeconds: 10
        successThreshold: 1
        timeoutSeconds: 999
      resources: {}
      restartPolicy: Always
      terminationMessagePath: /dev/termination-log
      terminationMessagePolicy: File
      volumeMounts:
        - mountPath: /var/run/secrets/kubernetes.io/serviceaccount
          name: kube-api-access-rjr2p
          readOnly: true
  preemptionPolicy: PreemptLowerPriority
  priority: 0
  restartPolicy: Always
  schedulerName: default-scheduler
  securityContext: {}
  serviceAccount: default
  serviceAccountName: default
  terminationGracePeriodSeconds: 30
  tolerations:
    - effect: NoExecute
      key: node.kubernetes.io/not-ready
      operator: Exists
      tolerationSeconds: 300
    - effect: NoExecute
      key: node.kubernetes.io/unreachable
      operator: Exists
      tolerationSeconds: 300
  volumes:
    - name: kube-api-access-rjr2p
      projected:
        defaultMode: 420
        sources:
          - serviceAccountToken:
              expirationSeconds: 3607
              path: token
          - configMap:
              items:
                - key: ca.crt
                  path: ca.crt
              name: kube-root-ca.crt
          - downwardAPI:
              items:
                - fieldRef:
                    apiVersion: v1
                    fieldPath: metadata.namespace
                  path: namespace
status:
  phase: Pending
  qosClass: BestEffort

# myapp   0/4     Pending   0          0s
# the pod has been scheduled but didn't initialize containers
---
apiVersion: v1
kind: Pod
metadata:
  annotations:
    kubectl.kubernetes.io/last-applied-configuration: |
      {"apiVersion":"v1","kind":"Pod","metadata":{"annotations":{},"name":"myapp","namespace":"default"},"spec":{"containers":[{"args":["echo \"main container 1 is starting...\"\nwhile true; do\n  echo \"main container 1 is doing some tasks...\"\n  sleep 3\ndone\n"],"command":["sh","-c"],"image":"busybox:1.35","name":"main-container-1"},{"args":["echo \"main container 2 is starting...\"\nwhile true; do\n  echo \"main container 2 is doing some tasks...\"\n  sleep 3\ndone\n"],"command":["sh","-c"],"image":"busybox:1.35","name":"main-container-2"}],"initContainers":[{"args":["echo \"init container 1 is starting...\"\necho \"init container 1 is doing some tasks...\"\nsleep 10\necho \"init container 1 completed tasks and exited\"\n"],"command":["sh","-c"],"image":"busybox:1.35","name":"init-container-1"},{"args":["echo \"sidecar container 1 is starting...\"\nwhile true; do\n  echo \"sidecar container 1 is doing some tasks...\"\n  sleep 3\ndone\n"],"command":["sh","-c"],"image":"busybox:1.35","name":"sidecar-container-1","readinessProbe":{"exec":{"command":["/bin/sh","-c","echo \"readiness probe of sidecar container 1 is starting...\" \u003e\u003e /proc/1/fd/1\nsleep 30\necho \"readiness probe of sidecar container 1 passed successfully\" \u003e\u003e /proc/1/fd/1\n"]},"timeoutSeconds":999},"restartPolicy":"Always"},{"args":["echo \"sidecar container 2 is starting...\"\nwhile true; do\n  echo \"sidecar container 2 is doing some tasks...\"\n  sleep 3\ndone\n"],"command":["sh","-c"],"image":"busybox:1.35","name":"sidecar-container-2","readinessProbe":{"exec":{"command":["/bin/sh","-c","echo \"readiness probe of sidecar container 2 is starting...\" \u003e\u003e /proc/1/fd/1\nsleep 30\necho \"readiness probe of sidecar container 2 passed successfully\" \u003e\u003e /proc/1/fd/1\n"]},"timeoutSeconds":999},"restartPolicy":"Always"}]}}
  creationTimestamp: "2024-05-29T00:20:15Z"
  name: myapp
  namespace: default
  resourceVersion: "1221022"
  uid: 02f352b5-7041-4ce3-907c-ed66caf11ae6
spec:
  containers:
    - args:
        - |
          echo "main container 1 is starting..."
          while true; do
            echo "main container 1 is doing some tasks..."
            sleep 3
          done
      command:
        - sh
        - -c
      image: busybox:1.35
      imagePullPolicy: IfNotPresent
      name: main-container-1
      resources: {}
      terminationMessagePath: /dev/termination-log
      terminationMessagePolicy: File
      volumeMounts:
        - mountPath: /var/run/secrets/kubernetes.io/serviceaccount
          name: kube-api-access-rjr2p
          readOnly: true
    - args:
        - |
          echo "main container 2 is starting..."
          while true; do
            echo "main container 2 is doing some tasks..."
            sleep 3
          done
      command:
        - sh
        - -c
      image: busybox:1.35
      imagePullPolicy: IfNotPresent
      name: main-container-2
      resources: {}
      terminationMessagePath: /dev/termination-log
      terminationMessagePolicy: File
      volumeMounts:
        - mountPath: /var/run/secrets/kubernetes.io/serviceaccount
          name: kube-api-access-rjr2p
          readOnly: true
  dnsPolicy: ClusterFirst
  enableServiceLinks: true
  initContainers:
    - args:
        - |
          echo "init container 1 is starting..."
          echo "init container 1 is doing some tasks..."
          sleep 10
          echo "init container 1 completed tasks and exited"
      command:
        - sh
        - -c
      image: busybox:1.35
      imagePullPolicy: IfNotPresent
      name: init-container-1
      resources: {}
      terminationMessagePath: /dev/termination-log
      terminationMessagePolicy: File
      volumeMounts:
        - mountPath: /var/run/secrets/kubernetes.io/serviceaccount
          name: kube-api-access-rjr2p
          readOnly: true
    - args:
        - |
          echo "sidecar container 1 is starting..."
          while true; do
            echo "sidecar container 1 is doing some tasks..."
            sleep 3
          done
      command:
        - sh
        - -c
      image: busybox:1.35
      imagePullPolicy: IfNotPresent
      name: sidecar-container-1
      readinessProbe:
        exec:
          command:
            - /bin/sh
            - -c
            - |
              echo "readiness probe of sidecar container 1 is starting..." >> /proc/1/fd/1
              sleep 30
              echo "readiness probe of sidecar container 1 passed successfully" >> /proc/1/fd/1
        failureThreshold: 3
        periodSeconds: 10
        successThreshold: 1
        timeoutSeconds: 999
      resources: {}
      restartPolicy: Always
      terminationMessagePath: /dev/termination-log
      terminationMessagePolicy: File
      volumeMounts:
        - mountPath: /var/run/secrets/kubernetes.io/serviceaccount
          name: kube-api-access-rjr2p
          readOnly: true
    - args:
        - |
          echo "sidecar container 2 is starting..."
          while true; do
            echo "sidecar container 2 is doing some tasks..."
            sleep 3
          done
      command:
        - sh
        - -c
      image: busybox:1.35
      imagePullPolicy: IfNotPresent
      name: sidecar-container-2
      readinessProbe:
        exec:
          command:
            - /bin/sh
            - -c
            - |
              echo "readiness probe of sidecar container 2 is starting..." >> /proc/1/fd/1
              sleep 30
              echo "readiness probe of sidecar container 2 passed successfully" >> /proc/1/fd/1
        failureThreshold: 3
        periodSeconds: 10
        successThreshold: 1
        timeoutSeconds: 999
      resources: {}
      restartPolicy: Always
      terminationMessagePath: /dev/termination-log
      terminationMessagePolicy: File
      volumeMounts:
        - mountPath: /var/run/secrets/kubernetes.io/serviceaccount
          name: kube-api-access-rjr2p
          readOnly: true
  nodeName: sidecar-demo-cluster-control-plane
  preemptionPolicy: PreemptLowerPriority
  priority: 0
  restartPolicy: Always
  schedulerName: default-scheduler
  securityContext: {}
  serviceAccount: default
  serviceAccountName: default
  terminationGracePeriodSeconds: 30
  tolerations:
    - effect: NoExecute
      key: node.kubernetes.io/not-ready
      operator: Exists
      tolerationSeconds: 300
    - effect: NoExecute
      key: node.kubernetes.io/unreachable
      operator: Exists
      tolerationSeconds: 300
  volumes:
    - name: kube-api-access-rjr2p
      projected:
        defaultMode: 420
        sources:
          - serviceAccountToken:
              expirationSeconds: 3607
              path: token
          - configMap:
              items:
                - key: ca.crt
                  path: ca.crt
              name: kube-root-ca.crt
          - downwardAPI:
              items:
                - fieldRef:
                    apiVersion: v1
                    fieldPath: metadata.namespace
                  path: namespace
status:
  conditions:
    - lastProbeTime: null
      lastTransitionTime: "2024-05-29T00:20:15Z"
      status: "True"
      type: PodScheduled
  phase: Pending
  qosClass: BestEffort

# myapp   0/4     Init:0/3   0          0s
# waiting for the init-container-1 to be created
---
apiVersion: v1
kind: Pod
metadata:
  annotations:
    kubectl.kubernetes.io/last-applied-configuration: |
      {"apiVersion":"v1","kind":"Pod","metadata":{"annotations":{},"name":"myapp","namespace":"default"},"spec":{"containers":[{"args":["echo \"main container 1 is starting...\"\nwhile true; do\n  echo \"main container 1 is doing some tasks...\"\n  sleep 3\ndone\n"],"command":["sh","-c"],"image":"busybox:1.35","name":"main-container-1"},{"args":["echo \"main container 2 is starting...\"\nwhile true; do\n  echo \"main container 2 is doing some tasks...\"\n  sleep 3\ndone\n"],"command":["sh","-c"],"image":"busybox:1.35","name":"main-container-2"}],"initContainers":[{"args":["echo \"init container 1 is starting...\"\necho \"init container 1 is doing some tasks...\"\nsleep 10\necho \"init container 1 completed tasks and exited\"\n"],"command":["sh","-c"],"image":"busybox:1.35","name":"init-container-1"},{"args":["echo \"sidecar container 1 is starting...\"\nwhile true; do\n  echo \"sidecar container 1 is doing some tasks...\"\n  sleep 3\ndone\n"],"command":["sh","-c"],"image":"busybox:1.35","name":"sidecar-container-1","readinessProbe":{"exec":{"command":["/bin/sh","-c","echo \"readiness probe of sidecar container 1 is starting...\" \u003e\u003e /proc/1/fd/1\nsleep 30\necho \"readiness probe of sidecar container 1 passed successfully\" \u003e\u003e /proc/1/fd/1\n"]},"timeoutSeconds":999},"restartPolicy":"Always"},{"args":["echo \"sidecar container 2 is starting...\"\nwhile true; do\n  echo \"sidecar container 2 is doing some tasks...\"\n  sleep 3\ndone\n"],"command":["sh","-c"],"image":"busybox:1.35","name":"sidecar-container-2","readinessProbe":{"exec":{"command":["/bin/sh","-c","echo \"readiness probe of sidecar container 2 is starting...\" \u003e\u003e /proc/1/fd/1\nsleep 30\necho \"readiness probe of sidecar container 2 passed successfully\" \u003e\u003e /proc/1/fd/1\n"]},"timeoutSeconds":999},"restartPolicy":"Always"}]}}
  creationTimestamp: "2024-05-29T00:20:15Z"
  name: myapp
  namespace: default
  resourceVersion: "1221024"
  uid: 02f352b5-7041-4ce3-907c-ed66caf11ae6
spec:
  containers:
    - args:
        - |
          echo "main container 1 is starting..."
          while true; do
            echo "main container 1 is doing some tasks..."
            sleep 3
          done
      command:
        - sh
        - -c
      image: busybox:1.35
      imagePullPolicy: IfNotPresent
      name: main-container-1
      resources: {}
      terminationMessagePath: /dev/termination-log
      terminationMessagePolicy: File
      volumeMounts:
        - mountPath: /var/run/secrets/kubernetes.io/serviceaccount
          name: kube-api-access-rjr2p
          readOnly: true
    - args:
        - |
          echo "main container 2 is starting..."
          while true; do
            echo "main container 2 is doing some tasks..."
            sleep 3
          done
      command:
        - sh
        - -c
      image: busybox:1.35
      imagePullPolicy: IfNotPresent
      name: main-container-2
      resources: {}
      terminationMessagePath: /dev/termination-log
      terminationMessagePolicy: File
      volumeMounts:
        - mountPath: /var/run/secrets/kubernetes.io/serviceaccount
          name: kube-api-access-rjr2p
          readOnly: true
  dnsPolicy: ClusterFirst
  enableServiceLinks: true
  initContainers:
    - args:
        - |
          echo "init container 1 is starting..."
          echo "init container 1 is doing some tasks..."
          sleep 10
          echo "init container 1 completed tasks and exited"
      command:
        - sh
        - -c
      image: busybox:1.35
      imagePullPolicy: IfNotPresent
      name: init-container-1
      resources: {}
      terminationMessagePath: /dev/termination-log
      terminationMessagePolicy: File
      volumeMounts:
        - mountPath: /var/run/secrets/kubernetes.io/serviceaccount
          name: kube-api-access-rjr2p
          readOnly: true
    - args:
        - |
          echo "sidecar container 1 is starting..."
          while true; do
            echo "sidecar container 1 is doing some tasks..."
            sleep 3
          done
      command:
        - sh
        - -c
      image: busybox:1.35
      imagePullPolicy: IfNotPresent
      name: sidecar-container-1
      readinessProbe:
        exec:
          command:
            - /bin/sh
            - -c
            - |
              echo "readiness probe of sidecar container 1 is starting..." >> /proc/1/fd/1
              sleep 30
              echo "readiness probe of sidecar container 1 passed successfully" >> /proc/1/fd/1
        failureThreshold: 3
        periodSeconds: 10
        successThreshold: 1
        timeoutSeconds: 999
      resources: {}
      restartPolicy: Always
      terminationMessagePath: /dev/termination-log
      terminationMessagePolicy: File
      volumeMounts:
        - mountPath: /var/run/secrets/kubernetes.io/serviceaccount
          name: kube-api-access-rjr2p
          readOnly: true
    - args:
        - |
          echo "sidecar container 2 is starting..."
          while true; do
            echo "sidecar container 2 is doing some tasks..."
            sleep 3
          done
      command:
        - sh
        - -c
      image: busybox:1.35
      imagePullPolicy: IfNotPresent
      name: sidecar-container-2
      readinessProbe:
        exec:
          command:
            - /bin/sh
            - -c
            - |
              echo "readiness probe of sidecar container 2 is starting..." >> /proc/1/fd/1
              sleep 30
              echo "readiness probe of sidecar container 2 passed successfully" >> /proc/1/fd/1
        failureThreshold: 3
        periodSeconds: 10
        successThreshold: 1
        timeoutSeconds: 999
      resources: {}
      restartPolicy: Always
      terminationMessagePath: /dev/termination-log
      terminationMessagePolicy: File
      volumeMounts:
        - mountPath: /var/run/secrets/kubernetes.io/serviceaccount
          name: kube-api-access-rjr2p
          readOnly: true
  nodeName: sidecar-demo-cluster-control-plane
  preemptionPolicy: PreemptLowerPriority
  priority: 0
  restartPolicy: Always
  schedulerName: default-scheduler
  securityContext: {}
  serviceAccount: default
  serviceAccountName: default
  terminationGracePeriodSeconds: 30
  tolerations:
    - effect: NoExecute
      key: node.kubernetes.io/not-ready
      operator: Exists
      tolerationSeconds: 300
    - effect: NoExecute
      key: node.kubernetes.io/unreachable
      operator: Exists
      tolerationSeconds: 300
  volumes:
    - name: kube-api-access-rjr2p
      projected:
        defaultMode: 420
        sources:
          - serviceAccountToken:
              expirationSeconds: 3607
              path: token
          - configMap:
              items:
                - key: ca.crt
                  path: ca.crt
              name: kube-root-ca.crt
          - downwardAPI:
              items:
                - fieldRef:
                    apiVersion: v1
                    fieldPath: metadata.namespace
                  path: namespace
status:
  conditions:
    - lastProbeTime: null
      lastTransitionTime: "2024-05-29T00:20:15Z"
      message: 'containers with incomplete status: [init-container-1 sidecar-container-1
      sidecar-container-2]'
      reason: ContainersNotInitialized
      status: "False"
      type: Initialized
    - lastProbeTime: null
      lastTransitionTime: "2024-05-29T00:20:15Z"
      message: 'containers with unready status: [sidecar-container-1 sidecar-container-2
      main-container-1 main-container-2]'
      reason: ContainersNotReady
      status: "False"
      type: Ready
    - lastProbeTime: null
      lastTransitionTime: "2024-05-29T00:20:15Z"
      message: 'containers with unready status: [sidecar-container-1 sidecar-container-2
      main-container-1 main-container-2]'
      reason: ContainersNotReady
      status: "False"
      type: ContainersReady
    - lastProbeTime: null
      lastTransitionTime: "2024-05-29T00:20:15Z"
      status: "True"
      type: PodScheduled
  containerStatuses:
    - image: busybox:1.35
      imageID: ""
      lastState: {}
      name: main-container-1
      ready: false
      restartCount: 0
      started: false
      state:
        waiting:
          reason: PodInitializing
    - image: busybox:1.35
      imageID: ""
      lastState: {}
      name: main-container-2
      ready: false
      restartCount: 0
      started: false
      state:
        waiting:
          reason: PodInitializing
  hostIP: 172.19.0.2
  initContainerStatuses:
    - image: busybox:1.35
      imageID: ""
      lastState: {}
      name: init-container-1
      ready: false
      restartCount: 0
      started: false
      state:
        waiting:
          reason: PodInitializing
    - image: busybox:1.35
      imageID: ""
      lastState: {}
      name: sidecar-container-1
      ready: false
      restartCount: 0
      started: false
      state:
        waiting:
          reason: PodInitializing
    - image: busybox:1.35
      imageID: ""
      lastState: {}
      name: sidecar-container-2
      ready: false
      restartCount: 0
      started: false
      state:
        waiting:
          reason: PodInitializing
  phase: Pending
  qosClass: BestEffort
  startTime: "2024-05-29T00:20:15Z"

# myapp   0/4     Init:0/3   0          1s
# the init-container-1 is running but doesn't complete yet
---
apiVersion: v1
kind: Pod
metadata:
  annotations:
    kubectl.kubernetes.io/last-applied-configuration: |
      {"apiVersion":"v1","kind":"Pod","metadata":{"annotations":{},"name":"myapp","namespace":"default"},"spec":{"containers":[{"args":["echo \"main container 1 is starting...\"\nwhile true; do\n  echo \"main container 1 is doing some tasks...\"\n  sleep 3\ndone\n"],"command":["sh","-c"],"image":"busybox:1.35","name":"main-container-1"},{"args":["echo \"main container 2 is starting...\"\nwhile true; do\n  echo \"main container 2 is doing some tasks...\"\n  sleep 3\ndone\n"],"command":["sh","-c"],"image":"busybox:1.35","name":"main-container-2"}],"initContainers":[{"args":["echo \"init container 1 is starting...\"\necho \"init container 1 is doing some tasks...\"\nsleep 10\necho \"init container 1 completed tasks and exited\"\n"],"command":["sh","-c"],"image":"busybox:1.35","name":"init-container-1"},{"args":["echo \"sidecar container 1 is starting...\"\nwhile true; do\n  echo \"sidecar container 1 is doing some tasks...\"\n  sleep 3\ndone\n"],"command":["sh","-c"],"image":"busybox:1.35","name":"sidecar-container-1","readinessProbe":{"exec":{"command":["/bin/sh","-c","echo \"readiness probe of sidecar container 1 is starting...\" \u003e\u003e /proc/1/fd/1\nsleep 30\necho \"readiness probe of sidecar container 1 passed successfully\" \u003e\u003e /proc/1/fd/1\n"]},"timeoutSeconds":999},"restartPolicy":"Always"},{"args":["echo \"sidecar container 2 is starting...\"\nwhile true; do\n  echo \"sidecar container 2 is doing some tasks...\"\n  sleep 3\ndone\n"],"command":["sh","-c"],"image":"busybox:1.35","name":"sidecar-container-2","readinessProbe":{"exec":{"command":["/bin/sh","-c","echo \"readiness probe of sidecar container 2 is starting...\" \u003e\u003e /proc/1/fd/1\nsleep 30\necho \"readiness probe of sidecar container 2 passed successfully\" \u003e\u003e /proc/1/fd/1\n"]},"timeoutSeconds":999},"restartPolicy":"Always"}]}}
  creationTimestamp: "2024-05-29T00:20:15Z"
  name: myapp
  namespace: default
  resourceVersion: "1221030"
  uid: 02f352b5-7041-4ce3-907c-ed66caf11ae6
spec:
  containers:
    - args:
        - |
          echo "main container 1 is starting..."
          while true; do
            echo "main container 1 is doing some tasks..."
            sleep 3
          done
      command:
        - sh
        - -c
      image: busybox:1.35
      imagePullPolicy: IfNotPresent
      name: main-container-1
      resources: {}
      terminationMessagePath: /dev/termination-log
      terminationMessagePolicy: File
      volumeMounts:
        - mountPath: /var/run/secrets/kubernetes.io/serviceaccount
          name: kube-api-access-rjr2p
          readOnly: true
    - args:
        - |
          echo "main container 2 is starting..."
          while true; do
            echo "main container 2 is doing some tasks..."
            sleep 3
          done
      command:
        - sh
        - -c
      image: busybox:1.35
      imagePullPolicy: IfNotPresent
      name: main-container-2
      resources: {}
      terminationMessagePath: /dev/termination-log
      terminationMessagePolicy: File
      volumeMounts:
        - mountPath: /var/run/secrets/kubernetes.io/serviceaccount
          name: kube-api-access-rjr2p
          readOnly: true
  dnsPolicy: ClusterFirst
  enableServiceLinks: true
  initContainers:
    - args:
        - |
          echo "init container 1 is starting..."
          echo "init container 1 is doing some tasks..."
          sleep 10
          echo "init container 1 completed tasks and exited"
      command:
        - sh
        - -c
      image: busybox:1.35
      imagePullPolicy: IfNotPresent
      name: init-container-1
      resources: {}
      terminationMessagePath: /dev/termination-log
      terminationMessagePolicy: File
      volumeMounts:
        - mountPath: /var/run/secrets/kubernetes.io/serviceaccount
          name: kube-api-access-rjr2p
          readOnly: true
    - args:
        - |
          echo "sidecar container 1 is starting..."
          while true; do
            echo "sidecar container 1 is doing some tasks..."
            sleep 3
          done
      command:
        - sh
        - -c
      image: busybox:1.35
      imagePullPolicy: IfNotPresent
      name: sidecar-container-1
      readinessProbe:
        exec:
          command:
            - /bin/sh
            - -c
            - |
              echo "readiness probe of sidecar container 1 is starting..." >> /proc/1/fd/1
              sleep 30
              echo "readiness probe of sidecar container 1 passed successfully" >> /proc/1/fd/1
        failureThreshold: 3
        periodSeconds: 10
        successThreshold: 1
        timeoutSeconds: 999
      resources: {}
      restartPolicy: Always
      terminationMessagePath: /dev/termination-log
      terminationMessagePolicy: File
      volumeMounts:
        - mountPath: /var/run/secrets/kubernetes.io/serviceaccount
          name: kube-api-access-rjr2p
          readOnly: true
    - args:
        - |
          echo "sidecar container 2 is starting..."
          while true; do
            echo "sidecar container 2 is doing some tasks..."
            sleep 3
          done
      command:
        - sh
        - -c
      image: busybox:1.35
      imagePullPolicy: IfNotPresent
      name: sidecar-container-2
      readinessProbe:
        exec:
          command:
            - /bin/sh
            - -c
            - |
              echo "readiness probe of sidecar container 2 is starting..." >> /proc/1/fd/1
              sleep 30
              echo "readiness probe of sidecar container 2 passed successfully" >> /proc/1/fd/1
        failureThreshold: 3
        periodSeconds: 10
        successThreshold: 1
        timeoutSeconds: 999
      resources: {}
      restartPolicy: Always
      terminationMessagePath: /dev/termination-log
      terminationMessagePolicy: File
      volumeMounts:
        - mountPath: /var/run/secrets/kubernetes.io/serviceaccount
          name: kube-api-access-rjr2p
          readOnly: true
  nodeName: sidecar-demo-cluster-control-plane
  preemptionPolicy: PreemptLowerPriority
  priority: 0
  restartPolicy: Always
  schedulerName: default-scheduler
  securityContext: {}
  serviceAccount: default
  serviceAccountName: default
  terminationGracePeriodSeconds: 30
  tolerations:
    - effect: NoExecute
      key: node.kubernetes.io/not-ready
      operator: Exists
      tolerationSeconds: 300
    - effect: NoExecute
      key: node.kubernetes.io/unreachable
      operator: Exists
      tolerationSeconds: 300
  volumes:
    - name: kube-api-access-rjr2p
      projected:
        defaultMode: 420
        sources:
          - serviceAccountToken:
              expirationSeconds: 3607
              path: token
          - configMap:
              items:
                - key: ca.crt
                  path: ca.crt
              name: kube-root-ca.crt
          - downwardAPI:
              items:
                - fieldRef:
                    apiVersion: v1
                    fieldPath: metadata.namespace
                  path: namespace
status:
  conditions:
    - lastProbeTime: null
      lastTransitionTime: "2024-05-29T00:20:15Z"
      message: 'containers with incomplete status: [init-container-1 sidecar-container-1
      sidecar-container-2]'
      reason: ContainersNotInitialized
      status: "False"
      type: Initialized
    - lastProbeTime: null
      lastTransitionTime: "2024-05-29T00:20:15Z"
      message: 'containers with unready status: [sidecar-container-1 sidecar-container-2
      main-container-1 main-container-2]'
      reason: ContainersNotReady
      status: "False"
      type: Ready
    - lastProbeTime: null
      lastTransitionTime: "2024-05-29T00:20:15Z"
      message: 'containers with unready status: [sidecar-container-1 sidecar-container-2
      main-container-1 main-container-2]'
      reason: ContainersNotReady
      status: "False"
      type: ContainersReady
    - lastProbeTime: null
      lastTransitionTime: "2024-05-29T00:20:15Z"
      status: "True"
      type: PodScheduled
  containerStatuses:
    - image: busybox:1.35
      imageID: ""
      lastState: {}
      name: main-container-1
      ready: false
      restartCount: 0
      started: false
      state:
        waiting:
          reason: PodInitializing
    - image: busybox:1.35
      imageID: ""
      lastState: {}
      name: main-container-2
      ready: false
      restartCount: 0
      started: false
      state:
        waiting:
          reason: PodInitializing
  hostIP: 172.19.0.2
  initContainerStatuses:
    - containerID: containerd://f509c2ed15176e8ab7fcd3c0316fde75969a4fbb4d86a96e05ed271591062caf
      image: docker.io/library/busybox:1.35
      imageID: docker.io/library/busybox@sha256:469d6089bc898ead80a47dab258a127ffdae15342eab860be3be9ed2acdee33b
      lastState: {}
      name: init-container-1
      ready: false
      restartCount: 0
      started: true
      state:
        running:
          startedAt: "2024-05-29T00:20:15Z"
    - image: busybox:1.35
      imageID: ""
      lastState: {}
      name: sidecar-container-1
      ready: false
      restartCount: 0
      started: false
      state:
        waiting:
          reason: PodInitializing
    - image: busybox:1.35
      imageID: ""
      lastState: {}
      name: sidecar-container-2
      ready: false
      restartCount: 0
      started: false
      state:
        waiting:
          reason: PodInitializing
  phase: Pending
  podIP: 10.244.0.15
  podIPs:
    - ip: 10.244.0.15
  qosClass: BestEffort
  startTime: "2024-05-29T00:20:15Z"

# myapp   0/4     Init:1/3   0          11s
# the init-container-1 completed and exited, waiting for the sidecar-container-1 to be created
---
apiVersion: v1
kind: Pod
metadata:
  annotations:
    kubectl.kubernetes.io/last-applied-configuration: |
      {"apiVersion":"v1","kind":"Pod","metadata":{"annotations":{},"name":"myapp","namespace":"default"},"spec":{"containers":[{"args":["echo \"main container 1 is starting...\"\nwhile true; do\n  echo \"main container 1 is doing some tasks...\"\n  sleep 3\ndone\n"],"command":["sh","-c"],"image":"busybox:1.35","name":"main-container-1"},{"args":["echo \"main container 2 is starting...\"\nwhile true; do\n  echo \"main container 2 is doing some tasks...\"\n  sleep 3\ndone\n"],"command":["sh","-c"],"image":"busybox:1.35","name":"main-container-2"}],"initContainers":[{"args":["echo \"init container 1 is starting...\"\necho \"init container 1 is doing some tasks...\"\nsleep 10\necho \"init container 1 completed tasks and exited\"\n"],"command":["sh","-c"],"image":"busybox:1.35","name":"init-container-1"},{"args":["echo \"sidecar container 1 is starting...\"\nwhile true; do\n  echo \"sidecar container 1 is doing some tasks...\"\n  sleep 3\ndone\n"],"command":["sh","-c"],"image":"busybox:1.35","name":"sidecar-container-1","readinessProbe":{"exec":{"command":["/bin/sh","-c","echo \"readiness probe of sidecar container 1 is starting...\" \u003e\u003e /proc/1/fd/1\nsleep 30\necho \"readiness probe of sidecar container 1 passed successfully\" \u003e\u003e /proc/1/fd/1\n"]},"timeoutSeconds":999},"restartPolicy":"Always"},{"args":["echo \"sidecar container 2 is starting...\"\nwhile true; do\n  echo \"sidecar container 2 is doing some tasks...\"\n  sleep 3\ndone\n"],"command":["sh","-c"],"image":"busybox:1.35","name":"sidecar-container-2","readinessProbe":{"exec":{"command":["/bin/sh","-c","echo \"readiness probe of sidecar container 2 is starting...\" \u003e\u003e /proc/1/fd/1\nsleep 30\necho \"readiness probe of sidecar container 2 passed successfully\" \u003e\u003e /proc/1/fd/1\n"]},"timeoutSeconds":999},"restartPolicy":"Always"}]}}
  creationTimestamp: "2024-05-29T00:20:15Z"
  name: myapp
  namespace: default
  resourceVersion: "1221045"
  uid: 02f352b5-7041-4ce3-907c-ed66caf11ae6
spec:
  containers:
    - args:
        - |
          echo "main container 1 is starting..."
          while true; do
            echo "main container 1 is doing some tasks..."
            sleep 3
          done
      command:
        - sh
        - -c
      image: busybox:1.35
      imagePullPolicy: IfNotPresent
      name: main-container-1
      resources: {}
      terminationMessagePath: /dev/termination-log
      terminationMessagePolicy: File
      volumeMounts:
        - mountPath: /var/run/secrets/kubernetes.io/serviceaccount
          name: kube-api-access-rjr2p
          readOnly: true
    - args:
        - |
          echo "main container 2 is starting..."
          while true; do
            echo "main container 2 is doing some tasks..."
            sleep 3
          done
      command:
        - sh
        - -c
      image: busybox:1.35
      imagePullPolicy: IfNotPresent
      name: main-container-2
      resources: {}
      terminationMessagePath: /dev/termination-log
      terminationMessagePolicy: File
      volumeMounts:
        - mountPath: /var/run/secrets/kubernetes.io/serviceaccount
          name: kube-api-access-rjr2p
          readOnly: true
  dnsPolicy: ClusterFirst
  enableServiceLinks: true
  initContainers:
    - args:
        - |
          echo "init container 1 is starting..."
          echo "init container 1 is doing some tasks..."
          sleep 10
          echo "init container 1 completed tasks and exited"
      command:
        - sh
        - -c
      image: busybox:1.35
      imagePullPolicy: IfNotPresent
      name: init-container-1
      resources: {}
      terminationMessagePath: /dev/termination-log
      terminationMessagePolicy: File
      volumeMounts:
        - mountPath: /var/run/secrets/kubernetes.io/serviceaccount
          name: kube-api-access-rjr2p
          readOnly: true
    - args:
        - |
          echo "sidecar container 1 is starting..."
          while true; do
            echo "sidecar container 1 is doing some tasks..."
            sleep 3
          done
      command:
        - sh
        - -c
      image: busybox:1.35
      imagePullPolicy: IfNotPresent
      name: sidecar-container-1
      readinessProbe:
        exec:
          command:
            - /bin/sh
            - -c
            - |
              echo "readiness probe of sidecar container 1 is starting..." >> /proc/1/fd/1
              sleep 30
              echo "readiness probe of sidecar container 1 passed successfully" >> /proc/1/fd/1
        failureThreshold: 3
        periodSeconds: 10
        successThreshold: 1
        timeoutSeconds: 999
      resources: {}
      restartPolicy: Always
      terminationMessagePath: /dev/termination-log
      terminationMessagePolicy: File
      volumeMounts:
        - mountPath: /var/run/secrets/kubernetes.io/serviceaccount
          name: kube-api-access-rjr2p
          readOnly: true
    - args:
        - |
          echo "sidecar container 2 is starting..."
          while true; do
            echo "sidecar container 2 is doing some tasks..."
            sleep 3
          done
      command:
        - sh
        - -c
      image: busybox:1.35
      imagePullPolicy: IfNotPresent
      name: sidecar-container-2
      readinessProbe:
        exec:
          command:
            - /bin/sh
            - -c
            - |
              echo "readiness probe of sidecar container 2 is starting..." >> /proc/1/fd/1
              sleep 30
              echo "readiness probe of sidecar container 2 passed successfully" >> /proc/1/fd/1
        failureThreshold: 3
        periodSeconds: 10
        successThreshold: 1
        timeoutSeconds: 999
      resources: {}
      restartPolicy: Always
      terminationMessagePath: /dev/termination-log
      terminationMessagePolicy: File
      volumeMounts:
        - mountPath: /var/run/secrets/kubernetes.io/serviceaccount
          name: kube-api-access-rjr2p
          readOnly: true
  nodeName: sidecar-demo-cluster-control-plane
  preemptionPolicy: PreemptLowerPriority
  priority: 0
  restartPolicy: Always
  schedulerName: default-scheduler
  securityContext: {}
  serviceAccount: default
  serviceAccountName: default
  terminationGracePeriodSeconds: 30
  tolerations:
    - effect: NoExecute
      key: node.kubernetes.io/not-ready
      operator: Exists
      tolerationSeconds: 300
    - effect: NoExecute
      key: node.kubernetes.io/unreachable
      operator: Exists
      tolerationSeconds: 300
  volumes:
    - name: kube-api-access-rjr2p
      projected:
        defaultMode: 420
        sources:
          - serviceAccountToken:
              expirationSeconds: 3607
              path: token
          - configMap:
              items:
                - key: ca.crt
                  path: ca.crt
              name: kube-root-ca.crt
          - downwardAPI:
              items:
                - fieldRef:
                    apiVersion: v1
                    fieldPath: metadata.namespace
                  path: namespace
status:
  conditions:
    - lastProbeTime: null
      lastTransitionTime: "2024-05-29T00:20:15Z"
      message: 'containers with incomplete status: [sidecar-container-1 sidecar-container-2]'
      reason: ContainersNotInitialized
      status: "False"
      type: Initialized
    - lastProbeTime: null
      lastTransitionTime: "2024-05-29T00:20:15Z"
      message: 'containers with unready status: [sidecar-container-1 sidecar-container-2
      main-container-1 main-container-2]'
      reason: ContainersNotReady
      status: "False"
      type: Ready
    - lastProbeTime: null
      lastTransitionTime: "2024-05-29T00:20:15Z"
      message: 'containers with unready status: [sidecar-container-1 sidecar-container-2
      main-container-1 main-container-2]'
      reason: ContainersNotReady
      status: "False"
      type: ContainersReady
    - lastProbeTime: null
      lastTransitionTime: "2024-05-29T00:20:15Z"
      status: "True"
      type: PodScheduled
  containerStatuses:
    - image: busybox:1.35
      imageID: ""
      lastState: {}
      name: main-container-1
      ready: false
      restartCount: 0
      started: false
      state:
        waiting:
          reason: PodInitializing
    - image: busybox:1.35
      imageID: ""
      lastState: {}
      name: main-container-2
      ready: false
      restartCount: 0
      started: false
      state:
        waiting:
          reason: PodInitializing
  hostIP: 172.19.0.2
  initContainerStatuses:
    - containerID: containerd://f509c2ed15176e8ab7fcd3c0316fde75969a4fbb4d86a96e05ed271591062caf
      image: docker.io/library/busybox:1.35
      imageID: docker.io/library/busybox@sha256:469d6089bc898ead80a47dab258a127ffdae15342eab860be3be9ed2acdee33b
      lastState: {}
      name: init-container-1
      ready: true
      restartCount: 0
      started: false
      state:
        terminated:
          containerID: containerd://f509c2ed15176e8ab7fcd3c0316fde75969a4fbb4d86a96e05ed271591062caf
          exitCode: 0
          finishedAt: "2024-05-29T00:20:25Z"
          reason: Completed
          startedAt: "2024-05-29T00:20:15Z"
    - image: busybox:1.35
      imageID: ""
      lastState: {}
      name: sidecar-container-1
      ready: false
      restartCount: 0
      started: false
      state:
        waiting:
          reason: PodInitializing
    - image: busybox:1.35
      imageID: ""
      lastState: {}
      name: sidecar-container-2
      ready: false
      restartCount: 0
      started: false
      state:
        waiting:
          reason: PodInitializing
  phase: Pending
  podIP: 10.244.0.15
  podIPs:
    - ip: 10.244.0.15
  qosClass: BestEffort
  startTime: "2024-05-29T00:20:15Z"

# myapp   0/4     Init:2/3   0          12s
# the sidecar-container-1 is running, waiting for the sidecar-container-2 to be created
---
apiVersion: v1
kind: Pod
metadata:
  annotations:
    kubectl.kubernetes.io/last-applied-configuration: |
      {"apiVersion":"v1","kind":"Pod","metadata":{"annotations":{},"name":"myapp","namespace":"default"},"spec":{"containers":[{"args":["echo \"main container 1 is starting...\"\nwhile true; do\n  echo \"main container 1 is doing some tasks...\"\n  sleep 3\ndone\n"],"command":["sh","-c"],"image":"busybox:1.35","name":"main-container-1"},{"args":["echo \"main container 2 is starting...\"\nwhile true; do\n  echo \"main container 2 is doing some tasks...\"\n  sleep 3\ndone\n"],"command":["sh","-c"],"image":"busybox:1.35","name":"main-container-2"}],"initContainers":[{"args":["echo \"init container 1 is starting...\"\necho \"init container 1 is doing some tasks...\"\nsleep 10\necho \"init container 1 completed tasks and exited\"\n"],"command":["sh","-c"],"image":"busybox:1.35","name":"init-container-1"},{"args":["echo \"sidecar container 1 is starting...\"\nwhile true; do\n  echo \"sidecar container 1 is doing some tasks...\"\n  sleep 3\ndone\n"],"command":["sh","-c"],"image":"busybox:1.35","name":"sidecar-container-1","readinessProbe":{"exec":{"command":["/bin/sh","-c","echo \"readiness probe of sidecar container 1 is starting...\" \u003e\u003e /proc/1/fd/1\nsleep 30\necho \"readiness probe of sidecar container 1 passed successfully\" \u003e\u003e /proc/1/fd/1\n"]},"timeoutSeconds":999},"restartPolicy":"Always"},{"args":["echo \"sidecar container 2 is starting...\"\nwhile true; do\n  echo \"sidecar container 2 is doing some tasks...\"\n  sleep 3\ndone\n"],"command":["sh","-c"],"image":"busybox:1.35","name":"sidecar-container-2","readinessProbe":{"exec":{"command":["/bin/sh","-c","echo \"readiness probe of sidecar container 2 is starting...\" \u003e\u003e /proc/1/fd/1\nsleep 30\necho \"readiness probe of sidecar container 2 passed successfully\" \u003e\u003e /proc/1/fd/1\n"]},"timeoutSeconds":999},"restartPolicy":"Always"}]}}
  creationTimestamp: "2024-05-29T00:20:15Z"
  name: myapp
  namespace: default
  resourceVersion: "1221051"
  uid: 02f352b5-7041-4ce3-907c-ed66caf11ae6
spec:
  containers:
    - args:
        - |
          echo "main container 1 is starting..."
          while true; do
            echo "main container 1 is doing some tasks..."
            sleep 3
          done
      command:
        - sh
        - -c
      image: busybox:1.35
      imagePullPolicy: IfNotPresent
      name: main-container-1
      resources: {}
      terminationMessagePath: /dev/termination-log
      terminationMessagePolicy: File
      volumeMounts:
        - mountPath: /var/run/secrets/kubernetes.io/serviceaccount
          name: kube-api-access-rjr2p
          readOnly: true
    - args:
        - |
          echo "main container 2 is starting..."
          while true; do
            echo "main container 2 is doing some tasks..."
            sleep 3
          done
      command:
        - sh
        - -c
      image: busybox:1.35
      imagePullPolicy: IfNotPresent
      name: main-container-2
      resources: {}
      terminationMessagePath: /dev/termination-log
      terminationMessagePolicy: File
      volumeMounts:
        - mountPath: /var/run/secrets/kubernetes.io/serviceaccount
          name: kube-api-access-rjr2p
          readOnly: true
  dnsPolicy: ClusterFirst
  enableServiceLinks: true
  initContainers:
    - args:
        - |
          echo "init container 1 is starting..."
          echo "init container 1 is doing some tasks..."
          sleep 10
          echo "init container 1 completed tasks and exited"
      command:
        - sh
        - -c
      image: busybox:1.35
      imagePullPolicy: IfNotPresent
      name: init-container-1
      resources: {}
      terminationMessagePath: /dev/termination-log
      terminationMessagePolicy: File
      volumeMounts:
        - mountPath: /var/run/secrets/kubernetes.io/serviceaccount
          name: kube-api-access-rjr2p
          readOnly: true
    - args:
        - |
          echo "sidecar container 1 is starting..."
          while true; do
            echo "sidecar container 1 is doing some tasks..."
            sleep 3
          done
      command:
        - sh
        - -c
      image: busybox:1.35
      imagePullPolicy: IfNotPresent
      name: sidecar-container-1
      readinessProbe:
        exec:
          command:
            - /bin/sh
            - -c
            - |
              echo "readiness probe of sidecar container 1 is starting..." >> /proc/1/fd/1
              sleep 30
              echo "readiness probe of sidecar container 1 passed successfully" >> /proc/1/fd/1
        failureThreshold: 3
        periodSeconds: 10
        successThreshold: 1
        timeoutSeconds: 999
      resources: {}
      restartPolicy: Always
      terminationMessagePath: /dev/termination-log
      terminationMessagePolicy: File
      volumeMounts:
        - mountPath: /var/run/secrets/kubernetes.io/serviceaccount
          name: kube-api-access-rjr2p
          readOnly: true
    - args:
        - |
          echo "sidecar container 2 is starting..."
          while true; do
            echo "sidecar container 2 is doing some tasks..."
            sleep 3
          done
      command:
        - sh
        - -c
      image: busybox:1.35
      imagePullPolicy: IfNotPresent
      name: sidecar-container-2
      readinessProbe:
        exec:
          command:
            - /bin/sh
            - -c
            - |
              echo "readiness probe of sidecar container 2 is starting..." >> /proc/1/fd/1
              sleep 30
              echo "readiness probe of sidecar container 2 passed successfully" >> /proc/1/fd/1
        failureThreshold: 3
        periodSeconds: 10
        successThreshold: 1
        timeoutSeconds: 999
      resources: {}
      restartPolicy: Always
      terminationMessagePath: /dev/termination-log
      terminationMessagePolicy: File
      volumeMounts:
        - mountPath: /var/run/secrets/kubernetes.io/serviceaccount
          name: kube-api-access-rjr2p
          readOnly: true
  nodeName: sidecar-demo-cluster-control-plane
  preemptionPolicy: PreemptLowerPriority
  priority: 0
  restartPolicy: Always
  schedulerName: default-scheduler
  securityContext: {}
  serviceAccount: default
  serviceAccountName: default
  terminationGracePeriodSeconds: 30
  tolerations:
    - effect: NoExecute
      key: node.kubernetes.io/not-ready
      operator: Exists
      tolerationSeconds: 300
    - effect: NoExecute
      key: node.kubernetes.io/unreachable
      operator: Exists
      tolerationSeconds: 300
  volumes:
    - name: kube-api-access-rjr2p
      projected:
        defaultMode: 420
        sources:
          - serviceAccountToken:
              expirationSeconds: 3607
              path: token
          - configMap:
              items:
                - key: ca.crt
                  path: ca.crt
              name: kube-root-ca.crt
          - downwardAPI:
              items:
                - fieldRef:
                    apiVersion: v1
                    fieldPath: metadata.namespace
                  path: namespace
status:
  conditions:
    - lastProbeTime: null
      lastTransitionTime: "2024-05-29T00:20:15Z"
      message: 'containers with incomplete status: [sidecar-container-2]'
      reason: ContainersNotInitialized
      status: "False"
      type: Initialized
    - lastProbeTime: null
      lastTransitionTime: "2024-05-29T00:20:15Z"
      message: 'containers with unready status: [sidecar-container-1 sidecar-container-2
      main-container-1 main-container-2]'
      reason: ContainersNotReady
      status: "False"
      type: Ready
    - lastProbeTime: null
      lastTransitionTime: "2024-05-29T00:20:15Z"
      message: 'containers with unready status: [sidecar-container-1 sidecar-container-2
      main-container-1 main-container-2]'
      reason: ContainersNotReady
      status: "False"
      type: ContainersReady
    - lastProbeTime: null
      lastTransitionTime: "2024-05-29T00:20:15Z"
      status: "True"
      type: PodScheduled
  containerStatuses:
    - image: busybox:1.35
      imageID: ""
      lastState: {}
      name: main-container-1
      ready: false
      restartCount: 0
      started: false
      state:
        waiting:
          reason: PodInitializing
    - image: busybox:1.35
      imageID: ""
      lastState: {}
      name: main-container-2
      ready: false
      restartCount: 0
      started: false
      state:
        waiting:
          reason: PodInitializing
  hostIP: 172.19.0.2
  initContainerStatuses:
    - containerID: containerd://f509c2ed15176e8ab7fcd3c0316fde75969a4fbb4d86a96e05ed271591062caf
      image: docker.io/library/busybox:1.35
      imageID: docker.io/library/busybox@sha256:469d6089bc898ead80a47dab258a127ffdae15342eab860be3be9ed2acdee33b
      lastState: {}
      name: init-container-1
      ready: true
      restartCount: 0
      started: false
      state:
        terminated:
          containerID: containerd://f509c2ed15176e8ab7fcd3c0316fde75969a4fbb4d86a96e05ed271591062caf
          exitCode: 0
          finishedAt: "2024-05-29T00:20:25Z"
          reason: Completed
          startedAt: "2024-05-29T00:20:15Z"
    - containerID: containerd://6cc29d3973f225205e352db58c6ecef66744357134bd8acd2d2b58ea3846d627
      image: docker.io/library/busybox:1.35
      imageID: docker.io/library/busybox@sha256:469d6089bc898ead80a47dab258a127ffdae15342eab860be3be9ed2acdee33b
      lastState: {}
      name: sidecar-container-1
      ready: false
      restartCount: 0
      started: true
      state:
        running:
          startedAt: "2024-05-29T00:20:26Z"
    - image: busybox:1.35
      imageID: ""
      lastState: {}
      name: sidecar-container-2
      ready: false
      restartCount: 0
      started: false
      state:
        waiting:
          reason: PodInitializing
  phase: Pending
  podIP: 10.244.0.15
  podIPs:
    - ip: 10.244.0.15
  qosClass: BestEffort
  startTime: "2024-05-29T00:20:15Z"


# myapp   0/4     PodInitializing   0          13s
# the sidecar-container-2 is running, waiting for the main-container-1 and main-container-2 to be created
---
apiVersion: v1
kind: Pod
metadata:
  annotations:
    kubectl.kubernetes.io/last-applied-configuration: |
      {"apiVersion":"v1","kind":"Pod","metadata":{"annotations":{},"name":"myapp","namespace":"default"},"spec":{"containers":[{"args":["echo \"main container 1 is starting...\"\nwhile true; do\n  echo \"main container 1 is doing some tasks...\"\n  sleep 3\ndone\n"],"command":["sh","-c"],"image":"busybox:1.35","name":"main-container-1"},{"args":["echo \"main container 2 is starting...\"\nwhile true; do\n  echo \"main container 2 is doing some tasks...\"\n  sleep 3\ndone\n"],"command":["sh","-c"],"image":"busybox:1.35","name":"main-container-2"}],"initContainers":[{"args":["echo \"init container 1 is starting...\"\necho \"init container 1 is doing some tasks...\"\nsleep 10\necho \"init container 1 completed tasks and exited\"\n"],"command":["sh","-c"],"image":"busybox:1.35","name":"init-container-1"},{"args":["echo \"sidecar container 1 is starting...\"\nwhile true; do\n  echo \"sidecar container 1 is doing some tasks...\"\n  sleep 3\ndone\n"],"command":["sh","-c"],"image":"busybox:1.35","name":"sidecar-container-1","readinessProbe":{"exec":{"command":["/bin/sh","-c","echo \"readiness probe of sidecar container 1 is starting...\" \u003e\u003e /proc/1/fd/1\nsleep 30\necho \"readiness probe of sidecar container 1 passed successfully\" \u003e\u003e /proc/1/fd/1\n"]},"timeoutSeconds":999},"restartPolicy":"Always"},{"args":["echo \"sidecar container 2 is starting...\"\nwhile true; do\n  echo \"sidecar container 2 is doing some tasks...\"\n  sleep 3\ndone\n"],"command":["sh","-c"],"image":"busybox:1.35","name":"sidecar-container-2","readinessProbe":{"exec":{"command":["/bin/sh","-c","echo \"readiness probe of sidecar container 2 is starting...\" \u003e\u003e /proc/1/fd/1\nsleep 30\necho \"readiness probe of sidecar container 2 passed successfully\" \u003e\u003e /proc/1/fd/1\n"]},"timeoutSeconds":999},"restartPolicy":"Always"}]}}
  creationTimestamp: "2024-05-29T00:20:15Z"
  name: myapp
  namespace: default
  resourceVersion: "1221055"
  uid: 02f352b5-7041-4ce3-907c-ed66caf11ae6
spec:
  containers:
    - args:
        - |
          echo "main container 1 is starting..."
          while true; do
            echo "main container 1 is doing some tasks..."
            sleep 3
          done
      command:
        - sh
        - -c
      image: busybox:1.35
      imagePullPolicy: IfNotPresent
      name: main-container-1
      resources: {}
      terminationMessagePath: /dev/termination-log
      terminationMessagePolicy: File
      volumeMounts:
        - mountPath: /var/run/secrets/kubernetes.io/serviceaccount
          name: kube-api-access-rjr2p
          readOnly: true
    - args:
        - |
          echo "main container 2 is starting..."
          while true; do
            echo "main container 2 is doing some tasks..."
            sleep 3
          done
      command:
        - sh
        - -c
      image: busybox:1.35
      imagePullPolicy: IfNotPresent
      name: main-container-2
      resources: {}
      terminationMessagePath: /dev/termination-log
      terminationMessagePolicy: File
      volumeMounts:
        - mountPath: /var/run/secrets/kubernetes.io/serviceaccount
          name: kube-api-access-rjr2p
          readOnly: true
  dnsPolicy: ClusterFirst
  enableServiceLinks: true
  initContainers:
    - args:
        - |
          echo "init container 1 is starting..."
          echo "init container 1 is doing some tasks..."
          sleep 10
          echo "init container 1 completed tasks and exited"
      command:
        - sh
        - -c
      image: busybox:1.35
      imagePullPolicy: IfNotPresent
      name: init-container-1
      resources: {}
      terminationMessagePath: /dev/termination-log
      terminationMessagePolicy: File
      volumeMounts:
        - mountPath: /var/run/secrets/kubernetes.io/serviceaccount
          name: kube-api-access-rjr2p
          readOnly: true
    - args:
        - |
          echo "sidecar container 1 is starting..."
          while true; do
            echo "sidecar container 1 is doing some tasks..."
            sleep 3
          done
      command:
        - sh
        - -c
      image: busybox:1.35
      imagePullPolicy: IfNotPresent
      name: sidecar-container-1
      readinessProbe:
        exec:
          command:
            - /bin/sh
            - -c
            - |
              echo "readiness probe of sidecar container 1 is starting..." >> /proc/1/fd/1
              sleep 30
              echo "readiness probe of sidecar container 1 passed successfully" >> /proc/1/fd/1
        failureThreshold: 3
        periodSeconds: 10
        successThreshold: 1
        timeoutSeconds: 999
      resources: {}
      restartPolicy: Always
      terminationMessagePath: /dev/termination-log
      terminationMessagePolicy: File
      volumeMounts:
        - mountPath: /var/run/secrets/kubernetes.io/serviceaccount
          name: kube-api-access-rjr2p
          readOnly: true
    - args:
        - |
          echo "sidecar container 2 is starting..."
          while true; do
            echo "sidecar container 2 is doing some tasks..."
            sleep 3
          done
      command:
        - sh
        - -c
      image: busybox:1.35
      imagePullPolicy: IfNotPresent
      name: sidecar-container-2
      readinessProbe:
        exec:
          command:
            - /bin/sh
            - -c
            - |
              echo "readiness probe of sidecar container 2 is starting..." >> /proc/1/fd/1
              sleep 30
              echo "readiness probe of sidecar container 2 passed successfully" >> /proc/1/fd/1
        failureThreshold: 3
        periodSeconds: 10
        successThreshold: 1
        timeoutSeconds: 999
      resources: {}
      restartPolicy: Always
      terminationMessagePath: /dev/termination-log
      terminationMessagePolicy: File
      volumeMounts:
        - mountPath: /var/run/secrets/kubernetes.io/serviceaccount
          name: kube-api-access-rjr2p
          readOnly: true
  nodeName: sidecar-demo-cluster-control-plane
  preemptionPolicy: PreemptLowerPriority
  priority: 0
  restartPolicy: Always
  schedulerName: default-scheduler
  securityContext: {}
  serviceAccount: default
  serviceAccountName: default
  terminationGracePeriodSeconds: 30
  tolerations:
    - effect: NoExecute
      key: node.kubernetes.io/not-ready
      operator: Exists
      tolerationSeconds: 300
    - effect: NoExecute
      key: node.kubernetes.io/unreachable
      operator: Exists
      tolerationSeconds: 300
  volumes:
    - name: kube-api-access-rjr2p
      projected:
        defaultMode: 420
        sources:
          - serviceAccountToken:
              expirationSeconds: 3607
              path: token
          - configMap:
              items:
                - key: ca.crt
                  path: ca.crt
              name: kube-root-ca.crt
          - downwardAPI:
              items:
                - fieldRef:
                    apiVersion: v1
                    fieldPath: metadata.namespace
                  path: namespace
status:
  conditions:
    - lastProbeTime: null
      lastTransitionTime: "2024-05-29T00:20:28Z"
      status: "True"
      type: Initialized
    - lastProbeTime: null
      lastTransitionTime: "2024-05-29T00:20:15Z"
      message: 'containers with unready status: [sidecar-container-1 sidecar-container-2
      main-container-1 main-container-2]'
      reason: ContainersNotReady
      status: "False"
      type: Ready
    - lastProbeTime: null
      lastTransitionTime: "2024-05-29T00:20:15Z"
      message: 'containers with unready status: [sidecar-container-1 sidecar-container-2
      main-container-1 main-container-2]'
      reason: ContainersNotReady
      status: "False"
      type: ContainersReady
    - lastProbeTime: null
      lastTransitionTime: "2024-05-29T00:20:15Z"
      status: "True"
      type: PodScheduled
  containerStatuses:
    - image: busybox:1.35
      imageID: ""
      lastState: {}
      name: main-container-1
      ready: false
      restartCount: 0
      started: false
      state:
        waiting:
          reason: PodInitializing
    - image: busybox:1.35
      imageID: ""
      lastState: {}
      name: main-container-2
      ready: false
      restartCount: 0
      started: false
      state:
        waiting:
          reason: PodInitializing
  hostIP: 172.19.0.2
  initContainerStatuses:
    - containerID: containerd://f509c2ed15176e8ab7fcd3c0316fde75969a4fbb4d86a96e05ed271591062caf
      image: docker.io/library/busybox:1.35
      imageID: docker.io/library/busybox@sha256:469d6089bc898ead80a47dab258a127ffdae15342eab860be3be9ed2acdee33b
      lastState: {}
      name: init-container-1
      ready: true
      restartCount: 0
      started: false
      state:
        terminated:
          containerID: containerd://f509c2ed15176e8ab7fcd3c0316fde75969a4fbb4d86a96e05ed271591062caf
          exitCode: 0
          finishedAt: "2024-05-29T00:20:25Z"
          reason: Completed
          startedAt: "2024-05-29T00:20:15Z"
    - containerID: containerd://6cc29d3973f225205e352db58c6ecef66744357134bd8acd2d2b58ea3846d627
      image: docker.io/library/busybox:1.35
      imageID: docker.io/library/busybox@sha256:469d6089bc898ead80a47dab258a127ffdae15342eab860be3be9ed2acdee33b
      lastState: {}
      name: sidecar-container-1
      ready: false
      restartCount: 0
      started: true
      state:
        running:
          startedAt: "2024-05-29T00:20:26Z"
    - containerID: containerd://f3187219eebb1b2fac206e2544fee846d59c8467e33f0629c4da283e0e4f0e5c
      image: docker.io/library/busybox:1.35
      imageID: docker.io/library/busybox@sha256:469d6089bc898ead80a47dab258a127ffdae15342eab860be3be9ed2acdee33b
      lastState: {}
      name: sidecar-container-2
      ready: false
      restartCount: 0
      started: true
      state:
        running:
          startedAt: "2024-05-29T00:20:27Z"
  phase: Pending
  podIP: 10.244.0.15
  podIPs:
    - ip: 10.244.0.15
  qosClass: BestEffort
  startTime: "2024-05-29T00:20:15Z"

# myapp   2/4     Running           0          14s
# the main-container-1 and main-container-2 are running, but sidecar-container-1 and sidecar-container-2 still not ready
---
apiVersion: v1
kind: Pod
metadata:
  annotations:
    kubectl.kubernetes.io/last-applied-configuration: |
      {"apiVersion":"v1","kind":"Pod","metadata":{"annotations":{},"name":"myapp","namespace":"default"},"spec":{"containers":[{"args":["echo \"main container 1 is starting...\"\nwhile true; do\n  echo \"main container 1 is doing some tasks...\"\n  sleep 3\ndone\n"],"command":["sh","-c"],"image":"busybox:1.35","name":"main-container-1"},{"args":["echo \"main container 2 is starting...\"\nwhile true; do\n  echo \"main container 2 is doing some tasks...\"\n  sleep 3\ndone\n"],"command":["sh","-c"],"image":"busybox:1.35","name":"main-container-2"}],"initContainers":[{"args":["echo \"init container 1 is starting...\"\necho \"init container 1 is doing some tasks...\"\nsleep 10\necho \"init container 1 completed tasks and exited\"\n"],"command":["sh","-c"],"image":"busybox:1.35","name":"init-container-1"},{"args":["echo \"sidecar container 1 is starting...\"\nwhile true; do\n  echo \"sidecar container 1 is doing some tasks...\"\n  sleep 3\ndone\n"],"command":["sh","-c"],"image":"busybox:1.35","name":"sidecar-container-1","readinessProbe":{"exec":{"command":["/bin/sh","-c","echo \"readiness probe of sidecar container 1 is starting...\" \u003e\u003e /proc/1/fd/1\nsleep 30\necho \"readiness probe of sidecar container 1 passed successfully\" \u003e\u003e /proc/1/fd/1\n"]},"timeoutSeconds":999},"restartPolicy":"Always"},{"args":["echo \"sidecar container 2 is starting...\"\nwhile true; do\n  echo \"sidecar container 2 is doing some tasks...\"\n  sleep 3\ndone\n"],"command":["sh","-c"],"image":"busybox:1.35","name":"sidecar-container-2","readinessProbe":{"exec":{"command":["/bin/sh","-c","echo \"readiness probe of sidecar container 2 is starting...\" \u003e\u003e /proc/1/fd/1\nsleep 30\necho \"readiness probe of sidecar container 2 passed successfully\" \u003e\u003e /proc/1/fd/1\n"]},"timeoutSeconds":999},"restartPolicy":"Always"}]}}
  creationTimestamp: "2024-05-29T00:20:15Z"
  name: myapp
  namespace: default
  resourceVersion: "1221063"
  uid: 02f352b5-7041-4ce3-907c-ed66caf11ae6
spec:
  containers:
    - args:
        - |
          echo "main container 1 is starting..."
          while true; do
            echo "main container 1 is doing some tasks..."
            sleep 3
          done
      command:
        - sh
        - -c
      image: busybox:1.35
      imagePullPolicy: IfNotPresent
      name: main-container-1
      resources: {}
      terminationMessagePath: /dev/termination-log
      terminationMessagePolicy: File
      volumeMounts:
        - mountPath: /var/run/secrets/kubernetes.io/serviceaccount
          name: kube-api-access-rjr2p
          readOnly: true
    - args:
        - |
          echo "main container 2 is starting..."
          while true; do
            echo "main container 2 is doing some tasks..."
            sleep 3
          done
      command:
        - sh
        - -c
      image: busybox:1.35
      imagePullPolicy: IfNotPresent
      name: main-container-2
      resources: {}
      terminationMessagePath: /dev/termination-log
      terminationMessagePolicy: File
      volumeMounts:
        - mountPath: /var/run/secrets/kubernetes.io/serviceaccount
          name: kube-api-access-rjr2p
          readOnly: true
  dnsPolicy: ClusterFirst
  enableServiceLinks: true
  initContainers:
    - args:
        - |
          echo "init container 1 is starting..."
          echo "init container 1 is doing some tasks..."
          sleep 10
          echo "init container 1 completed tasks and exited"
      command:
        - sh
        - -c
      image: busybox:1.35
      imagePullPolicy: IfNotPresent
      name: init-container-1
      resources: {}
      terminationMessagePath: /dev/termination-log
      terminationMessagePolicy: File
      volumeMounts:
        - mountPath: /var/run/secrets/kubernetes.io/serviceaccount
          name: kube-api-access-rjr2p
          readOnly: true
    - args:
        - |
          echo "sidecar container 1 is starting..."
          while true; do
            echo "sidecar container 1 is doing some tasks..."
            sleep 3
          done
      command:
        - sh
        - -c
      image: busybox:1.35
      imagePullPolicy: IfNotPresent
      name: sidecar-container-1
      readinessProbe:
        exec:
          command:
            - /bin/sh
            - -c
            - |
              echo "readiness probe of sidecar container 1 is starting..." >> /proc/1/fd/1
              sleep 30
              echo "readiness probe of sidecar container 1 passed successfully" >> /proc/1/fd/1
        failureThreshold: 3
        periodSeconds: 10
        successThreshold: 1
        timeoutSeconds: 999
      resources: {}
      restartPolicy: Always
      terminationMessagePath: /dev/termination-log
      terminationMessagePolicy: File
      volumeMounts:
        - mountPath: /var/run/secrets/kubernetes.io/serviceaccount
          name: kube-api-access-rjr2p
          readOnly: true
    - args:
        - |
          echo "sidecar container 2 is starting..."
          while true; do
            echo "sidecar container 2 is doing some tasks..."
            sleep 3
          done
      command:
        - sh
        - -c
      image: busybox:1.35
      imagePullPolicy: IfNotPresent
      name: sidecar-container-2
      readinessProbe:
        exec:
          command:
            - /bin/sh
            - -c
            - |
              echo "readiness probe of sidecar container 2 is starting..." >> /proc/1/fd/1
              sleep 30
              echo "readiness probe of sidecar container 2 passed successfully" >> /proc/1/fd/1
        failureThreshold: 3
        periodSeconds: 10
        successThreshold: 1
        timeoutSeconds: 999
      resources: {}
      restartPolicy: Always
      terminationMessagePath: /dev/termination-log
      terminationMessagePolicy: File
      volumeMounts:
        - mountPath: /var/run/secrets/kubernetes.io/serviceaccount
          name: kube-api-access-rjr2p
          readOnly: true
  nodeName: sidecar-demo-cluster-control-plane
  preemptionPolicy: PreemptLowerPriority
  priority: 0
  restartPolicy: Always
  schedulerName: default-scheduler
  securityContext: {}
  serviceAccount: default
  serviceAccountName: default
  terminationGracePeriodSeconds: 30
  tolerations:
    - effect: NoExecute
      key: node.kubernetes.io/not-ready
      operator: Exists
      tolerationSeconds: 300
    - effect: NoExecute
      key: node.kubernetes.io/unreachable
      operator: Exists
      tolerationSeconds: 300
  volumes:
    - name: kube-api-access-rjr2p
      projected:
        defaultMode: 420
        sources:
          - serviceAccountToken:
              expirationSeconds: 3607
              path: token
          - configMap:
              items:
                - key: ca.crt
                  path: ca.crt
              name: kube-root-ca.crt
          - downwardAPI:
              items:
                - fieldRef:
                    apiVersion: v1
                    fieldPath: metadata.namespace
                  path: namespace
status:
  conditions:
    - lastProbeTime: null
      lastTransitionTime: "2024-05-29T00:20:28Z"
      status: "True"
      type: Initialized
    - lastProbeTime: null
      lastTransitionTime: "2024-05-29T00:20:15Z"
      message: 'containers with unready status: [sidecar-container-1 sidecar-container-2]'
      reason: ContainersNotReady
      status: "False"
      type: Ready
    - lastProbeTime: null
      lastTransitionTime: "2024-05-29T00:20:15Z"
      message: 'containers with unready status: [sidecar-container-1 sidecar-container-2]'
      reason: ContainersNotReady
      status: "False"
      type: ContainersReady
    - lastProbeTime: null
      lastTransitionTime: "2024-05-29T00:20:15Z"
      status: "True"
      type: PodScheduled
  containerStatuses:
    - containerID: containerd://13c3266b4dcab42a8ff3de7efb4f021abfe7d550167f25684fe853b46fdea9ea
      image: docker.io/library/busybox:1.35
      imageID: docker.io/library/busybox@sha256:469d6089bc898ead80a47dab258a127ffdae15342eab860be3be9ed2acdee33b
      lastState: {}
      name: main-container-1
      ready: true
      restartCount: 0
      started: true
      state:
        running:
          startedAt: "2024-05-29T00:20:28Z"
    - containerID: containerd://c74cd79323e21a829a58aedcd0585ed6a0c5eb4d8ece908b133ec0fa2684c789
      image: docker.io/library/busybox:1.35
      imageID: docker.io/library/busybox@sha256:469d6089bc898ead80a47dab258a127ffdae15342eab860be3be9ed2acdee33b
      lastState: {}
      name: main-container-2
      ready: true
      restartCount: 0
      started: true
      state:
        running:
          startedAt: "2024-05-29T00:20:28Z"
  hostIP: 172.19.0.2
  initContainerStatuses:
    - containerID: containerd://f509c2ed15176e8ab7fcd3c0316fde75969a4fbb4d86a96e05ed271591062caf
      image: docker.io/library/busybox:1.35
      imageID: docker.io/library/busybox@sha256:469d6089bc898ead80a47dab258a127ffdae15342eab860be3be9ed2acdee33b
      lastState: {}
      name: init-container-1
      ready: true
      restartCount: 0
      started: false
      state:
        terminated:
          containerID: containerd://f509c2ed15176e8ab7fcd3c0316fde75969a4fbb4d86a96e05ed271591062caf
          exitCode: 0
          finishedAt: "2024-05-29T00:20:25Z"
          reason: Completed
          startedAt: "2024-05-29T00:20:15Z"
    - containerID: containerd://6cc29d3973f225205e352db58c6ecef66744357134bd8acd2d2b58ea3846d627
      image: docker.io/library/busybox:1.35
      imageID: docker.io/library/busybox@sha256:469d6089bc898ead80a47dab258a127ffdae15342eab860be3be9ed2acdee33b
      lastState: {}
      name: sidecar-container-1
      ready: false
      restartCount: 0
      started: true
      state:
        running:
          startedAt: "2024-05-29T00:20:26Z"
    - containerID: containerd://f3187219eebb1b2fac206e2544fee846d59c8467e33f0629c4da283e0e4f0e5c
      image: docker.io/library/busybox:1.35
      imageID: docker.io/library/busybox@sha256:469d6089bc898ead80a47dab258a127ffdae15342eab860be3be9ed2acdee33b
      lastState: {}
      name: sidecar-container-2
      ready: false
      restartCount: 0
      started: true
      state:
        running:
          startedAt: "2024-05-29T00:20:27Z"
  phase: Running
  podIP: 10.244.0.15
  podIPs:
    - ip: 10.244.0.15
  qosClass: BestEffort
  startTime: "2024-05-29T00:20:15Z"


# myapp   3/4     Running           0          14s
# sidecar-container-1 is ready (passed the readiness probe), but sidecar-container-2 still not ready
---
apiVersion: v1
kind: Pod
metadata:
  annotations:
    kubectl.kubernetes.io/last-applied-configuration: |
      {"apiVersion":"v1","kind":"Pod","metadata":{"annotations":{},"name":"myapp","namespace":"default"},"spec":{"containers":[{"args":["echo \"main container 1 is starting...\"\nwhile true; do\n  echo \"main container 1 is doing some tasks...\"\n  sleep 3\ndone\n"],"command":["sh","-c"],"image":"busybox:1.35","name":"main-container-1"},{"args":["echo \"main container 2 is starting...\"\nwhile true; do\n  echo \"main container 2 is doing some tasks...\"\n  sleep 3\ndone\n"],"command":["sh","-c"],"image":"busybox:1.35","name":"main-container-2"}],"initContainers":[{"args":["echo \"init container 1 is starting...\"\necho \"init container 1 is doing some tasks...\"\nsleep 10\necho \"init container 1 completed tasks and exited\"\n"],"command":["sh","-c"],"image":"busybox:1.35","name":"init-container-1"},{"args":["echo \"sidecar container 1 is starting...\"\nwhile true; do\n  echo \"sidecar container 1 is doing some tasks...\"\n  sleep 3\ndone\n"],"command":["sh","-c"],"image":"busybox:1.35","name":"sidecar-container-1","readinessProbe":{"exec":{"command":["/bin/sh","-c","echo \"readiness probe of sidecar container 1 is starting...\" \u003e\u003e /proc/1/fd/1\nsleep 30\necho \"readiness probe of sidecar container 1 passed successfully\" \u003e\u003e /proc/1/fd/1\n"]},"timeoutSeconds":999},"restartPolicy":"Always"},{"args":["echo \"sidecar container 2 is starting...\"\nwhile true; do\n  echo \"sidecar container 2 is doing some tasks...\"\n  sleep 3\ndone\n"],"command":["sh","-c"],"image":"busybox:1.35","name":"sidecar-container-2","readinessProbe":{"exec":{"command":["/bin/sh","-c","echo \"readiness probe of sidecar container 2 is starting...\" \u003e\u003e /proc/1/fd/1\nsleep 30\necho \"readiness probe of sidecar container 2 passed successfully\" \u003e\u003e /proc/1/fd/1\n"]},"timeoutSeconds":999},"restartPolicy":"Always"}]}}
  creationTimestamp: "2024-05-29T00:20:15Z"
  name: myapp
  namespace: default
  resourceVersion: "1221099"
  uid: 02f352b5-7041-4ce3-907c-ed66caf11ae6
spec:
  containers:
    - args:
        - |
          echo "main container 1 is starting..."
          while true; do
            echo "main container 1 is doing some tasks..."
            sleep 3
          done
      command:
        - sh
        - -c
      image: busybox:1.35
      imagePullPolicy: IfNotPresent
      name: main-container-1
      resources: {}
      terminationMessagePath: /dev/termination-log
      terminationMessagePolicy: File
      volumeMounts:
        - mountPath: /var/run/secrets/kubernetes.io/serviceaccount
          name: kube-api-access-rjr2p
          readOnly: true
    - args:
        - |
          echo "main container 2 is starting..."
          while true; do
            echo "main container 2 is doing some tasks..."
            sleep 3
          done
      command:
        - sh
        - -c
      image: busybox:1.35
      imagePullPolicy: IfNotPresent
      name: main-container-2
      resources: {}
      terminationMessagePath: /dev/termination-log
      terminationMessagePolicy: File
      volumeMounts:
        - mountPath: /var/run/secrets/kubernetes.io/serviceaccount
          name: kube-api-access-rjr2p
          readOnly: true
  dnsPolicy: ClusterFirst
  enableServiceLinks: true
  initContainers:
    - args:
        - |
          echo "init container 1 is starting..."
          echo "init container 1 is doing some tasks..."
          sleep 10
          echo "init container 1 completed tasks and exited"
      command:
        - sh
        - -c
      image: busybox:1.35
      imagePullPolicy: IfNotPresent
      name: init-container-1
      resources: {}
      terminationMessagePath: /dev/termination-log
      terminationMessagePolicy: File
      volumeMounts:
        - mountPath: /var/run/secrets/kubernetes.io/serviceaccount
          name: kube-api-access-rjr2p
          readOnly: true
    - args:
        - |
          echo "sidecar container 1 is starting..."
          while true; do
            echo "sidecar container 1 is doing some tasks..."
            sleep 3
          done
      command:
        - sh
        - -c
      image: busybox:1.35
      imagePullPolicy: IfNotPresent
      name: sidecar-container-1
      readinessProbe:
        exec:
          command:
            - /bin/sh
            - -c
            - |
              echo "readiness probe of sidecar container 1 is starting..." >> /proc/1/fd/1
              sleep 30
              echo "readiness probe of sidecar container 1 passed successfully" >> /proc/1/fd/1
        failureThreshold: 3
        periodSeconds: 10
        successThreshold: 1
        timeoutSeconds: 999
      resources: {}
      restartPolicy: Always
      terminationMessagePath: /dev/termination-log
      terminationMessagePolicy: File
      volumeMounts:
        - mountPath: /var/run/secrets/kubernetes.io/serviceaccount
          name: kube-api-access-rjr2p
          readOnly: true
    - args:
        - |
          echo "sidecar container 2 is starting..."
          while true; do
            echo "sidecar container 2 is doing some tasks..."
            sleep 3
          done
      command:
        - sh
        - -c
      image: busybox:1.35
      imagePullPolicy: IfNotPresent
      name: sidecar-container-2
      readinessProbe:
        exec:
          command:
            - /bin/sh
            - -c
            - |
              echo "readiness probe of sidecar container 2 is starting..." >> /proc/1/fd/1
              sleep 30
              echo "readiness probe of sidecar container 2 passed successfully" >> /proc/1/fd/1
        failureThreshold: 3
        periodSeconds: 10
        successThreshold: 1
        timeoutSeconds: 999
      resources: {}
      restartPolicy: Always
      terminationMessagePath: /dev/termination-log
      terminationMessagePolicy: File
      volumeMounts:
        - mountPath: /var/run/secrets/kubernetes.io/serviceaccount
          name: kube-api-access-rjr2p
          readOnly: true
  nodeName: sidecar-demo-cluster-control-plane
  preemptionPolicy: PreemptLowerPriority
  priority: 0
  restartPolicy: Always
  schedulerName: default-scheduler
  securityContext: {}
  serviceAccount: default
  serviceAccountName: default
  terminationGracePeriodSeconds: 30
  tolerations:
    - effect: NoExecute
      key: node.kubernetes.io/not-ready
      operator: Exists
      tolerationSeconds: 300
    - effect: NoExecute
      key: node.kubernetes.io/unreachable
      operator: Exists
      tolerationSeconds: 300
  volumes:
    - name: kube-api-access-rjr2p
      projected:
        defaultMode: 420
        sources:
          - serviceAccountToken:
              expirationSeconds: 3607
              path: token
          - configMap:
              items:
                - key: ca.crt
                  path: ca.crt
              name: kube-root-ca.crt
          - downwardAPI:
              items:
                - fieldRef:
                    apiVersion: v1
                    fieldPath: metadata.namespace
                  path: namespace
status:
  conditions:
    - lastProbeTime: null
      lastTransitionTime: "2024-05-29T00:20:28Z"
      status: "True"
      type: Initialized
    - lastProbeTime: null
      lastTransitionTime: "2024-05-29T00:20:15Z"
      message: 'containers with unready status: [sidecar-container-2]'
      reason: ContainersNotReady
      status: "False"
      type: Ready
    - lastProbeTime: null
      lastTransitionTime: "2024-05-29T00:20:15Z"
      message: 'containers with unready status: [sidecar-container-2]'
      reason: ContainersNotReady
      status: "False"
      type: ContainersReady
    - lastProbeTime: null
      lastTransitionTime: "2024-05-29T00:20:15Z"
      status: "True"
      type: PodScheduled
  containerStatuses:
    - containerID: containerd://13c3266b4dcab42a8ff3de7efb4f021abfe7d550167f25684fe853b46fdea9ea
      image: docker.io/library/busybox:1.35
      imageID: docker.io/library/busybox@sha256:469d6089bc898ead80a47dab258a127ffdae15342eab860be3be9ed2acdee33b
      lastState: {}
      name: main-container-1
      ready: true
      restartCount: 0
      started: true
      state:
        running:
          startedAt: "2024-05-29T00:20:28Z"
    - containerID: containerd://c74cd79323e21a829a58aedcd0585ed6a0c5eb4d8ece908b133ec0fa2684c789
      image: docker.io/library/busybox:1.35
      imageID: docker.io/library/busybox@sha256:469d6089bc898ead80a47dab258a127ffdae15342eab860be3be9ed2acdee33b
      lastState: {}
      name: main-container-2
      ready: true
      restartCount: 0
      started: true
      state:
        running:
          startedAt: "2024-05-29T00:20:28Z"
  hostIP: 172.19.0.2
  initContainerStatuses:
    - containerID: containerd://f509c2ed15176e8ab7fcd3c0316fde75969a4fbb4d86a96e05ed271591062caf
      image: docker.io/library/busybox:1.35
      imageID: docker.io/library/busybox@sha256:469d6089bc898ead80a47dab258a127ffdae15342eab860be3be9ed2acdee33b
      lastState: {}
      name: init-container-1
      ready: true
      restartCount: 0
      started: false
      state:
        terminated:
          containerID: containerd://f509c2ed15176e8ab7fcd3c0316fde75969a4fbb4d86a96e05ed271591062caf
          exitCode: 0
          finishedAt: "2024-05-29T00:20:25Z"
          reason: Completed
          startedAt: "2024-05-29T00:20:15Z"
    - containerID: containerd://6cc29d3973f225205e352db58c6ecef66744357134bd8acd2d2b58ea3846d627
      image: docker.io/library/busybox:1.35
      imageID: docker.io/library/busybox@sha256:469d6089bc898ead80a47dab258a127ffdae15342eab860be3be9ed2acdee33b
      lastState: {}
      name: sidecar-container-1
      ready: true
      restartCount: 0
      started: true
      state:
        running:
          startedAt: "2024-05-29T00:20:26Z"
    - containerID: containerd://f3187219eebb1b2fac206e2544fee846d59c8467e33f0629c4da283e0e4f0e5c
      image: docker.io/library/busybox:1.35
      imageID: docker.io/library/busybox@sha256:469d6089bc898ead80a47dab258a127ffdae15342eab860be3be9ed2acdee33b
      lastState: {}
      name: sidecar-container-2
      ready: false
      restartCount: 0
      started: true
      state:
        running:
          startedAt: "2024-05-29T00:20:27Z"
  phase: Running
  podIP: 10.244.0.15
  podIPs:
    - ip: 10.244.0.15
  qosClass: BestEffort
  startTime: "2024-05-29T00:20:15Z"

# myapp   4/4     Running           0          43s
# sidecar-container-2 is ready (passed the readiness probe)
# all containers are ready
---
apiVersion: v1
kind: Pod
metadata:
  annotations:
    kubectl.kubernetes.io/last-applied-configuration: |
      {"apiVersion":"v1","kind":"Pod","metadata":{"annotations":{},"name":"myapp","namespace":"default"},"spec":{"containers":[{"args":["echo \"main container 1 is starting...\"\nwhile true; do\n  echo \"main container 1 is doing some tasks...\"\n  sleep 3\ndone\n"],"command":["sh","-c"],"image":"busybox:1.35","name":"main-container-1"},{"args":["echo \"main container 2 is starting...\"\nwhile true; do\n  echo \"main container 2 is doing some tasks...\"\n  sleep 3\ndone\n"],"command":["sh","-c"],"image":"busybox:1.35","name":"main-container-2"}],"initContainers":[{"args":["echo \"init container 1 is starting...\"\necho \"init container 1 is doing some tasks...\"\nsleep 10\necho \"init container 1 completed tasks and exited\"\n"],"command":["sh","-c"],"image":"busybox:1.35","name":"init-container-1"},{"args":["echo \"sidecar container 1 is starting...\"\nwhile true; do\n  echo \"sidecar container 1 is doing some tasks...\"\n  sleep 3\ndone\n"],"command":["sh","-c"],"image":"busybox:1.35","name":"sidecar-container-1","readinessProbe":{"exec":{"command":["/bin/sh","-c","echo \"readiness probe of sidecar container 1 is starting...\" \u003e\u003e /proc/1/fd/1\nsleep 30\necho \"readiness probe of sidecar container 1 passed successfully\" \u003e\u003e /proc/1/fd/1\n"]},"timeoutSeconds":999},"restartPolicy":"Always"},{"args":["echo \"sidecar container 2 is starting...\"\nwhile true; do\n  echo \"sidecar container 2 is doing some tasks...\"\n  sleep 3\ndone\n"],"command":["sh","-c"],"image":"busybox:1.35","name":"sidecar-container-2","readinessProbe":{"exec":{"command":["/bin/sh","-c","echo \"readiness probe of sidecar container 2 is starting...\" \u003e\u003e /proc/1/fd/1\nsleep 30\necho \"readiness probe of sidecar container 2 passed successfully\" \u003e\u003e /proc/1/fd/1\n"]},"timeoutSeconds":999},"restartPolicy":"Always"}]}}
  creationTimestamp: "2024-05-29T00:20:15Z"
  name: myapp
  namespace: default
  resourceVersion: "1221102"
  uid: 02f352b5-7041-4ce3-907c-ed66caf11ae6
spec:
  containers:
    - args:
        - |
          echo "main container 1 is starting..."
          while true; do
            echo "main container 1 is doing some tasks..."
            sleep 3
          done
      command:
        - sh
        - -c
      image: busybox:1.35
      imagePullPolicy: IfNotPresent
      name: main-container-1
      resources: {}
      terminationMessagePath: /dev/termination-log
      terminationMessagePolicy: File
      volumeMounts:
        - mountPath: /var/run/secrets/kubernetes.io/serviceaccount
          name: kube-api-access-rjr2p
          readOnly: true
    - args:
        - |
          echo "main container 2 is starting..."
          while true; do
            echo "main container 2 is doing some tasks..."
            sleep 3
          done
      command:
        - sh
        - -c
      image: busybox:1.35
      imagePullPolicy: IfNotPresent
      name: main-container-2
      resources: {}
      terminationMessagePath: /dev/termination-log
      terminationMessagePolicy: File
      volumeMounts:
        - mountPath: /var/run/secrets/kubernetes.io/serviceaccount
          name: kube-api-access-rjr2p
          readOnly: true
  dnsPolicy: ClusterFirst
  enableServiceLinks: true
  initContainers:
    - args:
        - |
          echo "init container 1 is starting..."
          echo "init container 1 is doing some tasks..."
          sleep 10
          echo "init container 1 completed tasks and exited"
      command:
        - sh
        - -c
      image: busybox:1.35
      imagePullPolicy: IfNotPresent
      name: init-container-1
      resources: {}
      terminationMessagePath: /dev/termination-log
      terminationMessagePolicy: File
      volumeMounts:
        - mountPath: /var/run/secrets/kubernetes.io/serviceaccount
          name: kube-api-access-rjr2p
          readOnly: true
    - args:
        - |
          echo "sidecar container 1 is starting..."
          while true; do
            echo "sidecar container 1 is doing some tasks..."
            sleep 3
          done
      command:
        - sh
        - -c
      image: busybox:1.35
      imagePullPolicy: IfNotPresent
      name: sidecar-container-1
      readinessProbe:
        exec:
          command:
            - /bin/sh
            - -c
            - |
              echo "readiness probe of sidecar container 1 is starting..." >> /proc/1/fd/1
              sleep 30
              echo "readiness probe of sidecar container 1 passed successfully" >> /proc/1/fd/1
        failureThreshold: 3
        periodSeconds: 10
        successThreshold: 1
        timeoutSeconds: 999
      resources: {}
      restartPolicy: Always
      terminationMessagePath: /dev/termination-log
      terminationMessagePolicy: File
      volumeMounts:
        - mountPath: /var/run/secrets/kubernetes.io/serviceaccount
          name: kube-api-access-rjr2p
          readOnly: true
    - args:
        - |
          echo "sidecar container 2 is starting..."
          while true; do
            echo "sidecar container 2 is doing some tasks..."
            sleep 3
          done
      command:
        - sh
        - -c
      image: busybox:1.35
      imagePullPolicy: IfNotPresent
      name: sidecar-container-2
      readinessProbe:
        exec:
          command:
            - /bin/sh
            - -c
            - |
              echo "readiness probe of sidecar container 2 is starting..." >> /proc/1/fd/1
              sleep 30
              echo "readiness probe of sidecar container 2 passed successfully" >> /proc/1/fd/1
        failureThreshold: 3
        periodSeconds: 10
        successThreshold: 1
        timeoutSeconds: 999
      resources: {}
      restartPolicy: Always
      terminationMessagePath: /dev/termination-log
      terminationMessagePolicy: File
      volumeMounts:
        - mountPath: /var/run/secrets/kubernetes.io/serviceaccount
          name: kube-api-access-rjr2p
          readOnly: true
  nodeName: sidecar-demo-cluster-control-plane
  preemptionPolicy: PreemptLowerPriority
  priority: 0
  restartPolicy: Always
  schedulerName: default-scheduler
  securityContext: {}
  serviceAccount: default
  serviceAccountName: default
  terminationGracePeriodSeconds: 30
  tolerations:
    - effect: NoExecute
      key: node.kubernetes.io/not-ready
      operator: Exists
      tolerationSeconds: 300
    - effect: NoExecute
      key: node.kubernetes.io/unreachable
      operator: Exists
      tolerationSeconds: 300
  volumes:
    - name: kube-api-access-rjr2p
      projected:
        defaultMode: 420
        sources:
          - serviceAccountToken:
              expirationSeconds: 3607
              path: token
          - configMap:
              items:
                - key: ca.crt
                  path: ca.crt
              name: kube-root-ca.crt
          - downwardAPI:
              items:
                - fieldRef:
                    apiVersion: v1
                    fieldPath: metadata.namespace
                  path: namespace
status:
  conditions:
    - lastProbeTime: null
      lastTransitionTime: "2024-05-29T00:20:28Z"
      status: "True"
      type: Initialized
    - lastProbeTime: null
      lastTransitionTime: "2024-05-29T00:20:58Z"
      status: "True"
      type: Ready
    - lastProbeTime: null
      lastTransitionTime: "2024-05-29T00:20:58Z"
      status: "True"
      type: ContainersReady
    - lastProbeTime: null
      lastTransitionTime: "2024-05-29T00:20:15Z"
      status: "True"
      type: PodScheduled
  containerStatuses:
    - containerID: containerd://13c3266b4dcab42a8ff3de7efb4f021abfe7d550167f25684fe853b46fdea9ea
      image: docker.io/library/busybox:1.35
      imageID: docker.io/library/busybox@sha256:469d6089bc898ead80a47dab258a127ffdae15342eab860be3be9ed2acdee33b
      lastState: {}
      name: main-container-1
      ready: true
      restartCount: 0
      started: true
      state:
        running:
          startedAt: "2024-05-29T00:20:28Z"
    - containerID: containerd://c74cd79323e21a829a58aedcd0585ed6a0c5eb4d8ece908b133ec0fa2684c789
      image: docker.io/library/busybox:1.35
      imageID: docker.io/library/busybox@sha256:469d6089bc898ead80a47dab258a127ffdae15342eab860be3be9ed2acdee33b
      lastState: {}
      name: main-container-2
      ready: true
      restartCount: 0
      started: true
      state:
        running:
          startedAt: "2024-05-29T00:20:28Z"
  hostIP: 172.19.0.2
  initContainerStatuses:
    - containerID: containerd://f509c2ed15176e8ab7fcd3c0316fde75969a4fbb4d86a96e05ed271591062caf
      image: docker.io/library/busybox:1.35
      imageID: docker.io/library/busybox@sha256:469d6089bc898ead80a47dab258a127ffdae15342eab860be3be9ed2acdee33b
      lastState: {}
      name: init-container-1
      ready: true
      restartCount: 0
      started: false
      state:
        terminated:
          containerID: containerd://f509c2ed15176e8ab7fcd3c0316fde75969a4fbb4d86a96e05ed271591062caf
          exitCode: 0
          finishedAt: "2024-05-29T00:20:25Z"
          reason: Completed
          startedAt: "2024-05-29T00:20:15Z"
    - containerID: containerd://6cc29d3973f225205e352db58c6ecef66744357134bd8acd2d2b58ea3846d627
      image: docker.io/library/busybox:1.35
      imageID: docker.io/library/busybox@sha256:469d6089bc898ead80a47dab258a127ffdae15342eab860be3be9ed2acdee33b
      lastState: {}
      name: sidecar-container-1
      ready: true
      restartCount: 0
      started: true
      state:
        running:
          startedAt: "2024-05-29T00:20:26Z"
    - containerID: containerd://f3187219eebb1b2fac206e2544fee846d59c8467e33f0629c4da283e0e4f0e5c
      image: docker.io/library/busybox:1.35
      imageID: docker.io/library/busybox@sha256:469d6089bc898ead80a47dab258a127ffdae15342eab860be3be9ed2acdee33b
      lastState: {}
      name: sidecar-container-2
      ready: true
      restartCount: 0
      started: true
      state:
        running:
          startedAt: "2024-05-29T00:20:27Z"
  phase: Running
  podIP: 10.244.0.15
  podIPs:
    - ip: 10.244.0.15
  qosClass: BestEffort
  startTime: "2024-05-29T00:20:15Z"
